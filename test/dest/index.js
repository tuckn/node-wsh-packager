if(!console)var console={toString:function(s){var _getStr=function(s,indent){var i,I,p,r="",newIndent="  "+indent;if(void 0===s)r="undefined";else if(null===s)r="null";else if("Object"===Object.prototype.toString.call(s).slice(8,-1)){for(p in r="{\n",s)r+=newIndent+p+": "+_getStr(s[p],newIndent)+",\n";r=r.replace(/,\n$/,"\n"),r+=indent+"}"}else if("Array"===Object.prototype.toString.call(s).slice(8,-1)){for(r="[\n",i=0,I=s.length;i<I;i++)r+=newIndent+i+": "+_getStr(s[i],newIndent)+",\n";r=r.replace(/,\n$/,"\n"),r+=indent+"]"}else r="Boolean"===Object.prototype.toString.call(s).slice(8,-1)?s?"true":"false":"String"===Object.prototype.toString.call(s).slice(8,-1)?'"'+s+'"':s;return r};return _getStr(s,"")},log:function(s){"String"===Object.prototype.toString.call(s).slice(8,-1)?WScript.Echo(s):WScript.Echo(this.toString(s))}};"function"!=typeof Object.assign&&(Object.assign=function(target){"use strict";if(target===undefined||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var source,output=Object(target),i=1,I=arguments.length;i<I;i++)if((source=arguments[i])!==undefined&&null!==source)for(var nextKey in source)Object.prototype.hasOwnProperty.call(source,nextKey)&&(output[nextKey]=source[nextKey]);return output}),Object.keys||(Object.keys=function(){"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if("object"!=typeof obj&&("function"!=typeof obj||null===obj))throw new TypeError("Object.keys called on non-object");var prop,i,result=[];for(prop in obj)hasOwnProperty.call(obj,prop)&&result.push(prop);if(hasDontEnumBug)for(i=0;i<dontEnumsLength;i++)hasOwnProperty.call(obj,dontEnums[i])&&result.push(dontEnums[i]);return result}}()),Object.values||(Object.values=function(){"use strict";var hasProp=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if("object"!=typeof obj&&("function"!=typeof obj||null===obj))throw new TypeError("Object.values called on non-object");var prop,i,result=[];for(prop in obj)hasProp.call(obj,prop)&&result.push(obj[prop]);if(hasDontEnumBug)for(i=0;i<dontEnumsLength;i++)hasProp.call(obj,dontEnums[i])&&result.push(dontEnums[i]);return result}}()),"function"!=typeof Object.merge&&(Object.merge=function merge(target){"use strict";for(var source,output=target===undefined||null===target?{}:Object(target),i=1,I=arguments.length;i<I;i++)if((source=arguments[i])!==undefined&&null!==source)for(var nextKey in source)Object.prototype.hasOwnProperty.call(source,nextKey)&&("object"==typeof source[nextKey]?output[nextKey]=merge(output[nextKey],source[nextKey]):output[nextKey]=source[nextKey]);return output}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+|[\s\xA0]+$/g,"")}),"b"!="ab".substr(-1)&&(String.prototype.substr=function(substr){return function(start,length){return substr.call(this,start<0?this.length+start:start,length)}}(String.prototype.substr)),String.prototype.isProbablyEmpty||(String.prototype.isProbablyEmpty=function(){var r=this.toString();try{return null==r||""===r}catch(e){return!0}}),String.prototype.isAsciiCharOnly||(String.prototype.isAsciiCharOnly=function(){var i,I,code=0;for(i=0,I=this.length;i<I;i++)if(!(0<=(code=this.charCodeAt(i))&&code<129||63728==code||65377<=code&&code<65440||63729<=code&&code<63732))return!1;return!0}),String.prototype.toBoolean||(String.prototype.toBoolean=function(){return/^true$/i.test(this)}),String.prototype.toOneByteAlphaNumeric||(String.prototype.toOneByteAlphaNumeric=function(){return this.replace(/[Ａ-Ｚａ-ｚ０-９]/g,function(s){return String.fromCharCode(s.charCodeAt(0)-65248)})}),String.prototype.toZenkakuKana||(String.prototype.toZenkakuKana=function(){var kanaMap={"ｶﾞ":"ガ","ｷﾞ":"ギ","ｸﾞ":"グ","ｹﾞ":"ゲ","ｺﾞ":"ゴ","ｻﾞ":"ザ","ｼﾞ":"ジ","ｽﾞ":"ズ","ｾﾞ":"ゼ","ｿﾞ":"ゾ","ﾀﾞ":"ダ","ﾁﾞ":"ヂ","ﾂﾞ":"ヅ","ﾃﾞ":"デ","ﾄﾞ":"ド","ﾊﾞ":"バ","ﾋﾞ":"ビ","ﾌﾞ":"ブ","ﾍﾞ":"ベ","ﾎﾞ":"ボ","ﾊﾟ":"パ","ﾋﾟ":"ピ","ﾌﾟ":"プ","ﾍﾟ":"ペ","ﾎﾟ":"ポ","ｳﾞ":"ヴ","ﾜﾞ":"ヷ","ｦﾞ":"ヺ","ｱ":"ア","ｲ":"イ","ｳ":"ウ","ｴ":"エ","ｵ":"オ","ｶ":"カ","ｷ":"キ","ｸ":"ク","ｹ":"ケ","ｺ":"コ","ｻ":"サ","ｼ":"シ","ｽ":"ス","ｾ":"セ","ｿ":"ソ","ﾀ":"タ","ﾁ":"チ","ﾂ":"ツ","ﾃ":"テ","ﾄ":"ト","ﾅ":"ナ","ﾆ":"ニ","ﾇ":"ヌ","ﾈ":"ネ","ﾉ":"ノ","ﾊ":"ハ","ﾋ":"ヒ","ﾌ":"フ","ﾍ":"ヘ","ﾎ":"ホ","ﾏ":"マ","ﾐ":"ミ","ﾑ":"ム","ﾒ":"メ","ﾓ":"モ","ﾔ":"ヤ","ﾕ":"ユ","ﾖ":"ヨ","ﾗ":"ラ","ﾘ":"リ","ﾙ":"ル","ﾚ":"レ","ﾛ":"ロ","ﾜ":"ワ","ｦ":"ヲ","ﾝ":"ン","ｧ":"ァ","ｨ":"ィ","ｩ":"ゥ","ｪ":"ェ","ｫ":"ォ","ｯ":"ッ","ｬ":"ャ","ｭ":"ュ","ｮ":"ョ","｡":"。","､":"、","ｰ":"ー","｢":"「","｣":"」","･":"・"},reg=new RegExp("("+Object.keys(kanaMap).join("|")+")","g");return this.replace(reg,function(match){return kanaMap[match]}).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜")}),String.prototype.toTwoByteAlphaNumeric||(String.prototype.toTwoByteAlphaNumeric=function(){return this.replace(/[A-Za-z0-9]/g,function(s){return String.fromCharCode(s.charCodeAt(0)+65248)})}),String.prototype.toCmdArg||(String.prototype.toCmdArg=function(){var r=this.trim();return r=/^".+"$/.test(r)?'"'+r.match(/^"(.+)"$/i)[1].replace(/\\{0}"/g,'\\"')+'"':/\s/.test(r)?'"'+r.replace(/\\{0}"/g,'\\"')+'"':r.replace(/([\^&<>|])/g,"^$1")}),String.prototype.toFilePath||(String.prototype.toFilePath=function(){var r=this.toString().trim();return/^".+"$/.test(r)?r:/[a-z]:\\|\\\\[\w.]+\\/i.test(r)?/\s/i.test(r)?'"'+r+'"':!1===r.isAsciiCharOnly()?'"'+r+'"':-1!==r.indexOf("&")?'"'+r+'"':(/[/:*?"<>|]/i.test(r)&&(r='"'+r+'"'),r):r}),String.prototype.toRegExpStr||(String.prototype.toRegExpStr=function(){return this.toString().replace(/[\\/*+\-.?{}()[]^$|]/g,"\\$1")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){"use strict";if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0,n=0;if(0==len)return-1;if(0<arguments.length&&((n=Number(arguments[1]))!=n?n=0:0!==n&&n!=Infinity&&n!=-Infinity&&(n=(0<n||-1)*Math.floor(Math.abs(n)))),len<=n)return-1;for(var k=0<=n?n:Math.max(len-Math.abs(n),0);k<len;k++)if(k in t&&t[k]===searchElement)return k;return-1}),Array.prototype.filter||(Array.prototype.filter=function(fun){"use strict";if(null==this)throw new TypeError;if("function"!=typeof fun)throw new TypeError;for(var val,t=Object(this),len=t.length>>>0,res=[],thisp=arguments[1],i=0;i<len;i++)i in t&&(val=t[i],fun.call(thisp,val,i,t)&&res.push(val));return res}),Array.prototype.find||(Array.prototype.find=function(predicate){if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),len=o.length>>>0;if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var thisArg=arguments[1],k=0;k<len;){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o))return kValue;k++}return undefined}),Array.prototype.findIndex||(Array.prototype.findIndex=function(predicate){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var value,list=Object(this),length=list.length>>>0,thisArg=arguments[1],i=0;i<length;i++)if(value=list[i],predicate.call(thisArg,value,i,list))return i;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(callback){var T,k;if(null==this)throw new TypeError("this is null or not defined");var O=Object(this),len=O.length>>>0;if("function"!=typeof callback)throw new TypeError(callback+" is not a function");for(1<arguments.length&&(T=arguments[1]),k=0;k<len;){var kValue;k in O&&(kValue=O[k],callback.call(T,kValue,k,O)),k++}}),Array.prototype.map||(Array.prototype.map=function(callback){var T,A,k;if(null==this)throw new TypeError("this is null or not defined");var O=Object(this),len=O.length>>>0;if("function"!=typeof callback)throw new TypeError(callback+" is not a function");for(1<arguments.length&&(T=arguments[1]),A=new Array(len),k=0;k<len;){var kValue,mappedValue;k in O&&(kValue=O[k],mappedValue=callback.call(T,kValue,k,O),A[k]=mappedValue),k++}return A}),Array.prototype.reduce||(Array.prototype.reduce=function reduce(accumulator){if(null===this||this===undefined)throw new TypeError("Object is null or undefined");var curr,i=0,l=this.length>>0;if("function"!=typeof accumulator)throw new TypeError("First argument is not callable");if(arguments.length<2){if(0==l)throw new TypeError("Array length is 0 and no second argument");curr=this[0],i=1}else curr=arguments[1];for(;i<l;)i in this&&(curr=accumulator.call(undefined,curr,this[i],i,this)),++i;return curr}),Array.prototype.some||(Array.prototype.some=function(fun){"use strict";if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof fun)throw new TypeError;for(var t=Object(this),len=t.length>>>0,thisArg=2<=arguments.length?arguments[1]:void 0,i=0;i<len;i++)if(i in t&&fun.call(thisArg,t[i],i,t))return!0;return!1}),Error.prototype.toParsed||(Error.prototype.toParsed=function(){if(Object(this)!==this)throw new TypeError;var name=this.name;name=name===undefined?"Error":String(name);var msg=this.message;return msg=msg===undefined?"":String(msg),""===name?msg:""===msg?name:name+": "+msg}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(n){return n<10?"0"+n:n}function this_value(){return this.valueOf()}function quote(string){return rx_escapable.lastIndex=0,rx_escapable.test(string)?'"'+string.replace(rx_escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;i<length;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;i<length;i+=1)"string"==typeof rep[i]&&(v=str(k=rep[i],value))&&partial.push(quote(k)+(gap?": ":":")+v);else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=str(k,value))&&partial.push(quote(k)+(gap?": ":":")+v);return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(value,replacer,space){var i;if(indent=gap="","number"==typeof space)for(i=0;i<space;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if((rep=replacer)&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return str("",{"":value})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&((v=walk(value,k))!==undefined?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();
if(!Wsh)var Wsh={};Wsh.Util={},function(){var util=Wsh.Util;util.hasOwnProp=function(obj,prop){return!(!obj||!Object.prototype.hasOwnProperty.call(obj,prop))},util.extend=function(obj1,obj2){for(var p in obj2=obj2||{})util.hasOwnProp(obj2,p)&&(obj1[p]=obj2[p]);return obj1},util.deepClone=function(obj){return null===obj?obj:util.types.isArray(obj)?((rtnObj=obj.slice(0)||[]).forEach(function(val,i){("object"==typeof val&&val!=={}||util.types.isArray(val))&&(rtnObj[i]=util.deepClone(val))}),rtnObj):"object"==typeof obj?(rtnObj=Object.assign({},obj),Object.keys(rtnObj).forEach(function(key){"object"==typeof rtnObj[key]&&rtnObj[key]!=={}&&(rtnObj[key]=util.deepClone(rtnObj[key]))}),rtnObj):obj;var rtnObj},util.obtainPropVal=function(obj,propName,defaultVal){var returnVal="";return(util.types.isObject(obj)||util.types.isArray(obj))&&util.hasOwnProp(obj,propName)&&(returnVal=obj[propName]),util.types.isProbablyEmpty(returnVal)&&!util.types.isProbablyEmpty(defaultVal)&&(returnVal=defaultVal),returnVal},util.createDateStrAsIso8601=function(fmt,dateObj){var srcDate=util.types.isProbablyEmpty(dateObj)?new Date:dateObj,dataStr=util.types.isProbablyEmpty(fmt)?"yyyyMMddTHHmmss+hhmm":fmt;if(dataStr=dataStr.replace(/yyyy/i,srcDate.getFullYear()).replace(/MM/,("0"+(srcDate.getMonth()+1)).slice(-2)).replace(/dd/,("0"+srcDate.getDate()).slice(-2)).replace(/HH/,("0"+srcDate.getHours()).slice(-2)).replace(/mm/,("0"+srcDate.getMinutes()).slice(-2)).replace(/ss/,("0"+srcDate.getSeconds()).slice(-2)),/\+hh:?mm$/i.test(dataStr)){var eqtTime=(new Date).getTimezoneOffset()/60*-1,eqtTimeH=parseInt(eqtTime,10),eqtTimeM=eqtTime-eqtTimeH,eqtTimeHHStr=String(eqtTimeH),eqtTimeMMStr=String(eqtTimeM);1===eqtTimeHHStr.length&&(eqtTimeHHStr="0"+eqtTimeHHStr),1===eqtTimeMMStr.length&&(eqtTimeMMStr="0"+eqtTimeMMStr),dataStr=dataStr.replace(/\+(hh)/i,"+"+eqtTimeHHStr).replace(/mm$/i,eqtTimeMMStr)}return dataStr},util.getTypeName=function(obj){var sc=new ActiveXObject("ScriptControl");return sc.Language="VBScript",sc.AddCode("Function GetTypeName(obj): GetTypeName = TypeName(obj): End Function"),sc.Run("GetTypeName",obj)},util.convToVBArray=function(arr){var sc=new ActiveXObject("ScriptControl");return sc.Language="VBScript",sc.AddCode("Function makeArray\nmakeArray = Array("+arr+")\nEnd Function\n"),sc.Run("makeArray")},util.inArray=function(val,arr){return arr.indexOf(val)},util.assocToStr=function(assoc,prefix,postfix){return prefix=util.types.isProbablyEmpty(prefix)?"  ":prefix,postfix=util.types.isProbablyEmpty(postfix)?"\r\n":postfix,Object.keys(assoc).reduce(function(acc,val){return acc+prefix+val+": "+assoc[val]+postfix},"")},util.convErrToStr=function(e,spChr){var p,rtnStr="Error: {"+(spChr=util.types.isProbablyEmpty(spChr)?"\r\n":spChr);for(p in e)isNaN(e[p]),rtnStr+="  "+p+": "+e[p]+spChr;return rtnStr+="}"+spChr},util.conv2DArrayToAssocArray=function(arrays,options){for(var beginRowIdx=util.obtainPropVal(options,"beginRow",1)-1,beginColIdx=util.obtainPropVal(options,"beginColumn",1)-1,endRowIdx=util.obtainPropVal(options,"endRow",arrays.length),endColIdx=util.obtainPropVal(options,"endColumn",arrays[beginRowIdx].length),propNames=[],propName="",col=beginColIdx;col<endColIdx;col++)""===(propName=String(arrays[beginRowIdx][col]).trim())?propNames.push("empty"+col):-1===propNames.indexOf(propName)?propNames.push(propName):propNames.push(propName+col);for(var rtnAssoc=[],tmpAry=[],tmpObj={},row=1+beginRowIdx;row<endRowIdx;row++){tmpAry=arrays[row],tmpObj={};for(var col1=0,Col1=propNames.length;col1<Col1;col1++)beginColIdx+col1<tmpAry.length?tmpObj[propNames[col1]]=tmpAry[beginColIdx+col1]:tmpObj[propNames[col1]]=undefined;rtnAssoc.push(tmpObj)}return rtnAssoc},util.conv2DArrayToCsvStr=function(props,lineEnding){var items,item,key,line,csv="",keys=null,hasDoubleQuot=!1;lineEnding=util.types.isProbablyEmpty(lineEnding)?"\r\n":lineEnding;for(var i=0,I=props.length;i<I;i++){if(items=props[i],null===keys){for(key in keys=[],items)keys.push(key);csv+=keys.join(",")+lineEnding}line=[];for(var j=0,J=keys.length;j<J;j++)null!==(item=items[keys[j]])&&(hasDoubleQuot=!1,0<=(item=item instanceof Array?item.join(lineEnding):""+item).indexOf('"')?(hasDoubleQuot=!0,item=item.replace(/"/g,'""')):(0<=item.indexOf(",")||0<=item.indexOf("\r")||0<=item.indexOf("\n"))&&(hasDoubleQuot=!0),hasDoubleQuot&&(item='"'+item+'"')),line.push(item);csv+=line.join(",")+lineEnding}return csv},Wsh.Util.types={},util.types.typeOf=function(val){return val===undefined?"undefined":null===val?"null":Object.prototype.toString.call(val).slice(8,-1)},util.types.isArray=function(val){try{return"Array"===util.types.typeOf(val)}catch(e){return!1}},util.types.isBoolean=function(val){try{return"Boolean"===util.types.typeOf(val)}catch(e){return!1}},util.types.isFunction=function(val){try{return"Function"===util.types.typeOf(val)}catch(e){return!1}},util.types.isNumber=function(val){try{return"number"==typeof val&&isFinite(val)}catch(e){return!1}},util.types.isObject=function(val){try{return"Object"===util.types.typeOf(val)}catch(e){return!1}},util.types.isString=function(val){try{return val!==undefined&&null!==val&&"String"===util.types.typeOf(val)}catch(e){return!1}},util.types.isFalsy=function(val){return!val||!(!util.types.isString(val)||"FALSE"!==val.toUpperCase())},util.types.isTruthy=function(val){return!util.types.isFalsy(val)},util.types.isEmptyArray=function(val){return!(!util.types.isArray(val)||0!==val.length)},util.types.isEmptyObject=function(val){return!(!util.types.isObject(val)||0!==Object.keys(val).length)},util.types.isProbablyEmpty=function(val){try{return val===undefined||null===val||""===val||(!!util.types.isEmptyObject(val)||!!util.types.isEmptyArray(val))}catch(e){return!0}},util.types.isSameMeaning=function(str1,str2){try{return str1.toUpperCase()===str2.toUpperCase()}catch(e){return!1}},util.types.isPhoneNumerInJapan=function(str){try{return String(/^(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})$/i).test(str)}catch(e){return!1}},util.types.isProbablyPhoneNumberInJapan=function(str){try{return String(/^(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{3}|0[789]0-?\d{4}-?\d{3}|050-?\d{4}-?\d{3})\d?$/i).test(str)}catch(e){return!1}},util.types.isJapaneseName=function(val){try{return String(/^[^\x00-\x7F]+[(\p{blank})\s]*[^\x00-\x7F]+$/).test(val)||String(/^[a-z]+\s*[a-z]+$/i).test(val)&&String(/^[^lqvx]+$/i).test(val)&&String(/[^(bb|cc|dd|ff|gg|hh|jj|kk|ll|pp|rr|ss|tt|ww|yy|xx)]/i).test(val)&&String(/([aiueonkstnhfmyrwngzjdbp]|sh|ch|ts|ky|sh|ch|ny|hy|my|ry|gy|by|py)[aiueonmh]$/i).test(val)}catch(e){return!1}},util.types.isMailAddress=function(val){try{return String(/[\x00-\x7f]+@[\x00-\x7f]+/i).test(val)}catch(e){return!1}},util.types.isWellKnownFileExtion=function(val){try{return String(/\.(ahk|bat|bmp|doc|dxf|cmd|com|exe|js|jpg|pdf|png|ppf|ppt|tif|txt|iges|igs|mi|vsd|xls)/i).test(val)}catch(e){return!1}}}();
if(!Wsh)var Wsh={};Wsh.Constants={},function(){var CD=Wsh.Constants;CD.runOk=0,CD.runErr=1,CD.winHidden=0,CD.winActiveDef=1,CD.winActiveMin=2,CD.winActiveMax=3,CD.winNonActive=4,CD.winActive=5,CD.winNonActiveMin=7,CD.wait=!0,CD.notWait=!1,CD.successLog=0,CD.errLog=1,CD.warningLog=2,CD.infoLog=4,CD.logAuditSuccess=8,CD.logAuditFailure=16,CD.nonAutoClosing=0,CD.defDisplayingSec=10,CD.btnOk=0,CD.btnOkCancel=1,CD.btnStopRetryDisregard=2,CD.btnYesNoCancel=3,CD.btnYesNo=4,CD.btnRetryCancel=5,CD.icoStop=16,CD.icoQuestion=32,CD.icoExcl=48,CD.icoInfomaiton=64,CD.enterOk=1,CD.enterCancel=2,CD.enterStop=3,CD.enterRetry=4,CD.enterDisregard=5,CD.enterYes=6,CD.enterNo=7,CD.enterNot=-1,CD.forReading=1,CD.forWriting=2,CD.forAppending=8,CD.create=!0,CD.notCreate=!1,CD.cesUtf16=-1,CD.cesAscii=0,CD.cesCp932=-2,CD.jsOverwrite=!0,CD.jsNotOverwrite=!1,CD.jsDelReadOnly=!0,CD.jsNotDelReadOnly=!1,CD.adTypeBinary=1,CD.adTypeText=2,CD.adReadAll=-1,CD.adReadLine=-2,CD.adWriteChar=0,CD.adWriteLine=1,CD.adSaveCreateNotExist=1,CD.adSaveCreateOverWrite=2,CD.stdIn=0,CD.stdOut=1,CD.stdErr=2,CD.foWindows=0,CD.foSystem=1,CD.foTemp=2,CD.unknownDrive=0,CD.removableDrive=1,CD.hardDrive=2,CD.networkDrive=3,CD.cdromDrive=4,CD.ramDrive=5}();
var FILE_ATTRIBUTE_ARCHIVE=32,FILE_ATTRIBUTE_COMPRESSED=2048,FILE_ATTRIBUTE_DEVICE=64,FILE_ATTRIBUTE_DIRECTORY=16,FILE_ATTRIBUTE_FILE=17,FILE_ATTRIBUTE_ENCRYPTED=16384,FILE_ATTRIBUTE_HIDDEN=2,FILE_ATTRIBUTE_NORMAL=128,FILE_ATTRIBUTE_NOT_CONTENT_INDEXED=8192,FILE_ATTRIBUTE_OFFLINE=4096,FILE_ATTRIBUTE_READONLY=1,FILE_ATTRIBUTE_REPARSE_POINT=1024,FILE_ATTRIBUTE_SYMLINKD_DIR=1040,FILE_ATTRIBUTE_SYMLINKD_FILE=1056,FILE_ATTRIBUTE_SPARSE_FILE=512,FILE_ATTRIBUTE_SYSTEM=4,FILE_ATTRIBUTE_TEMPORARY=256,FILE_ATTRIBUTE_VIRTUAL=65536,vbOKOnly=0,vbOKCancel=1,vbAbortRetryIgnore=2,vbYesNoCancel=3,vbYesNo=4,vbRetryCancel=5,vbCritical=16,vbQuestion=32,vbExclamation=48,vbInformation=64,vbOk=1,vbCancel=2,vbAbort=3,vbRetry=4,vbIgnore=5,vbYes=6,vbNo=7,vbBlack=0,vbRed=255,vbGreen=65280,vbYellow=65535,vbBlue=16711680,vbMagenta=16711935,vbCyan=16776960,vbWhite=16777215;
if(!Wsh)var Wsh={};var __filename=WScript.ScriptFullName,__dirname=__filename.replace(/\\[^\\]+$/,"");Wsh.Path={},function(){var util=Wsh.Util,isEmp=util.types.isProbablyEmpty,isArray=util.types.isArray,isString=util.types.isString,fso=Wsh.FileSystemObject;fso=fso||WScript.CreateObject("Scripting.FileSystemObject");var sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var path=Wsh.Path;path.delimiter=";",path.sep="\\",path.ipc="IPC$",path.basename=function(pth,ext){return"string"==typeof ext&&""!==ext?fso.GetFileName(pth).replace(new RegExp(ext+"$"),""):fso.GetFileName(pth)},path.dirname=function(pth){return fso.GetParentFolderName(pth)},path.extname=function(pth){return"."+fso.GetExtensionName(pth)},path.isAbsolute=function(pth){return/^([a-z]:|\\\\[\w.]+)/i.test(pth)},path.normalize=function(pth){if(!isString(pth))throw new Error('TypeError [ERR_INVALID_ARG_TYPE]: The "path" argument must be of type string. Received type undefined');if(""===pth)return".";if("."===pth||".."===pth)return pth;var pt=pth.replace(/\//g,path.sep),head="";/^[a-z]:/i.test(pt)?head=pt.match(/^([a-z]:)/i)[1]:/^\\\\([^\\]+)/i.test(pt)&&(head=pt.match(/^(\\\\[^\\]+)/i)[1]);var normalized=pt.substring(head.length).split(path.sep).reduce(function(acc,branch){return isEmp(branch)||"."===branch?acc:".."===branch?acc.replace(/[^\\]+\\?$/,""):fso.BuildPath(acc,branch)},"");return""!==head&&(normalized=head+path.sep+normalized),pth.length-1===pth.lastIndexOf(path.sep)&&(normalized+=path.sep),normalized},path.join=function(){for(var pth="",i=0,I=arguments.length;i<I;++i){if(!isString(arguments[i]))throw new Error('TypeError [ERR_INVALID_ARG_TYPE]: The "path" argument must be of type string. Received type object');pth=fso.BuildPath(pth,arguments[i])}return path.normalize(pth)},path.parse=function(pth){try{return{root:/^([a-z]:\\|\\\\[^\\]+\\)/i.test(pth)?pth.match(/^([a-z]:\\|\\\\[^\\]+\\)/i)[1]:"",dir:path.dirname(pth),base:fso.GetFileName(pth),ext:path.extname(pth),name:fso.GetBaseName(pth)}}catch(e){throw WScript.Echo("Error in path.parse:\n  pth: "+pth),e}},path.relative=function(fromPath,toPath){fromPath=path.normalize(fromPath),toPath=path.normalize(toPath);for(var fromNodes=fromPath.split(path.sep),toNodes=toPath.split(path.sep),rtnRelPath=toPath,isUp=!1,i=0,I=fromNodes.length;i<I;i++)if(isUp||fromNodes[i].toLowerCase()!=toNodes[i].toLowerCase())if(isUp)isUp=!0,rtnRelPath=".."+path.sep+rtnRelPath;else{if(0===i)break;if(i===I-1&&fso.FileExists(fromPath)){rtnRelPath="."+path.sep+rtnRelPath;break}}else rtnRelPath=rtnRelPath.replace(toNodes[i]+path.sep,"");return rtnRelPath},path.resolve=function(pth){return isEmp(pth)?sh.CurrentDirectory:((rtnPath=path.isAbsolute(pth)?path.normalize(pth):isArray(pth)?pth.reduce(function(acc,p){return path.isAbsolute(p)?p:isEmp(acc)?path.join(sh.CurrentDirectory,p):path.join(acc,p)},""):path.join(sh.CurrentDirectory,pth)).length-1===rtnPath.lastIndexOf(path.sep)&&(rtnPath=rtnPath.substring(0,rtnPath.length-1)),rtnPath);var rtnPath},path.createTmpPath=function(prefix,postfix){var tmpDir=sh.ExpandEnvironmentStrings("%TMP%"),tmpName=fso.GetTempName();return util.types.isProbablyEmpty(prefix)&&(prefix=""),util.types.isProbablyEmpty(postfix)&&(postfix=""),fso.BuildPath(tmpDir,prefix+tmpName+postfix)}}();
if(!Wsh)var Wsh={};Wsh.FileSystem={},function(){var CD=Wsh.Constants,util=Wsh.Util,path=Wsh.Path,pullVal=util.obtainPropVal,isEmp=util.types.isProbablyEmpty,parseDate=util.createDateStrAsIso8601,sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var fso=Wsh.FileSystemObject;fso=fso||WScript.CreateObject("Scripting.FileSystemObject");var fs=Wsh.FileSystem,ERR_TITLE="Error in WshCore/FileSystem.js";fs.inspectPathWhetherMAX_PATH=function(fullPath){var pathLen=fullPath.length;if(255<pathLen)throw new Error(ERR_TITLE+"(inspectPathWhetherMAX_PATH)\nToo long file path! "+pathLen+' characters\n"'+fullPath+'"')},fs.constants={F_OK:0,R_OK:4,W_OK:2,X_OK:1,COPYFILE_EXCL:1,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,O_CREAT:256,O_EXCL:1024,O_TRUNC:512,O_APPEND:8,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFLNK:40960,UV_FS_COPYFILE_EXCL:1},fs.existsSync=function(fpath){return fs.inspectPathWhetherMAX_PATH(fpath),fso.FileExists(fpath)||fso.FolderExists(fpath)},fs.statSync=function(fpath){fs.inspectPathWhetherMAX_PATH(fpath);var isFile=fso.FileExists(fpath),isDirectory=fso.FolderExists(fpath);return{isFile:function(){return isFile},isDirectory:function(){return isDirectory},isSymbolickLink:function(){var fObj;util.types.isString(fpath)?isFile?fObj=fso.GetFile(fpath):isDirectory&&(fObj=fso.GetFolder(fpath)):fObj=fpath;var attr=fObj.Attributes+0;return attr===FILE_ATTRIBUTE_SYMLINKD_DIR||attr===FILE_ATTRIBUTE_SYMLINKD_FILE}}},fs.copyFileSync=function(src,dest,flag){if(fs.inspectPathWhetherMAX_PATH(src),fs.inspectPathWhetherMAX_PATH(dest),fso.FileExists(dest)&&flag===fs.constants.COPYFILE_EXCL)throw new Error(ERR_TITLE+"(copyFileSync)\nEXIST: file already exists, copyfile "+src+" -> "+dest);try{fso.CopyFile(src,dest,CD.jsOverwrite)}catch(e){throw new Error(ERR_TITLE+'(copyFileSync)\n  src: "'+src+'" -> dest: "'+dest+'"\n'+e.toParsed())}return!0},fs.mkdirSync=function(dpath){fs.inspectPathWhetherMAX_PATH(dpath),fso.CreateFolder(dpath)},fs.unlinkSync=function(fpath){fs.inspectPathWhetherMAX_PATH(fpath);try{if(!fso.FileExists(fpath))throw fso.FolderExists(fpath)?new Error("Error: EPERM: operation not permitted, unlink "+fpath):new Error("Error: ENOENT: no such file or directory, unlink "+fpath);fso.DeleteFile(fpath,CD.jsDelReadOnly)}catch(e){throw new Error(ERR_TITLE+'(unlinkSync)\n  Failed to delete "'+fpath+'"\n'+e.toParsed())}return!0},fs.rmdirSync=function(dpath){fs.inspectPathWhetherMAX_PATH(dpath);try{if(!fso.FolderExists(dpath))throw fso.FileExists(dpath)?new Error("Error: EPERM: operation not permitted, rmdir "+dpath):new Error("Error: ENOENT: no such file or directory, rmdir "+dpath);fso.DeleteFolder(dpath,CD.jsDelReadOnly)}catch(e){throw new Error(ERR_TITLE+'(rmdirSync)\n  Failed to delete "'+dpath+'"\n'+e.toParsed())}return!0},fs.readFileSync=function(fpath,options){if(!fs.existsSync(fpath))throw new Error('Error: ENOENT: no such file or directory, open the file "'+fpath+'". fs.readFileSync');var encoding=pullVal(options,"encoding","binary"),showsError=pullVal(options,"showsError",!0),strm=WScript.CreateObject("ADODB.Stream"),data="";isEmp(encoding)&&(encoding="binary");try{data=/^bin(ary)?$/i.test(encoding)?(strm.Type=CD.adTypeBinary,strm.Open(),strm.LoadFromFile(fpath),strm.Read(CD.adReadAll)):(strm.Type=CD.adTypeText,strm.Charset=/utf(-)?8/i.test(encoding)?"UTF-8":/utf(-)?16/i.test(encoding)?"Unicode":"Shift_JIS",strm.Open(),strm.LoadFromFile(fpath),strm.ReadText(CD.adReadAll)),strm.Close()}catch(e){if(showsError)throw new Error(ERR_TITLE+"(readFileSync)\n  file: "+fpath+"\n  encoding: "+encoding+"\n"+e.toParsed());throw e}return strm=null,data},fs.writeFileSync=function(fpath,data,options){fs.inspectPathWhetherMAX_PATH(fpath);var fso=Wsh.FileSystemObject;fso=fso||WScript.CreateObject("Scripting.FileSystemObject");var encoding=pullVal(options,"encoding","binary"),bom=pullVal(options,"bom",!1),strm=WScript.CreateObject("ADODB.Stream"),fpathTmp=path.createTmpPath();try{if(/^bin(ary)?$/i.test(encoding))return strm.Type=CD.adTypeBinary,strm.Open(),strm.Write(data),strm.SaveToFile(fpathTmp,CD.adSaveCreateOverWrite),strm.Close(),fso.CopyFile(fpathTmp,fpath,CD.jsOverwrite),fso.DeleteFile(fpathTmp,CD.jsDelReadOnly),!(strm=null);if(strm.Type=CD.adTypeText,strm.Charset=/utf(-)?8/i.test(encoding)?"UTF-8":/utf(-)?16/i.test(encoding)?"Unicode":"Shift_JIS",strm.Open(),strm.WriteText(data),"UTF-8"!==strm.Charset&&"Unicode"!==strm.Charset||bom)strm.SaveToFile(fpathTmp,CD.adSaveCreateOverWrite),strm.Close();else if(!bom){var binNoBom,bomLength="UTF-8"===strm.Charset?3:2,strmNoBom=WScript.CreateObject("ADODB.Stream");strm.Position=0,strm.Type=CD.adTypeBinary,strm.Position=bomLength,binNoBom=strm.Read(CD.adReadAll),strm.Close(),strmNoBom.Type=CD.adTypeBinary,strmNoBom.Open(),strmNoBom.Write(binNoBom),strmNoBom.SaveToFile(fpathTmp,CD.adSaveCreateOverWrite),strmNoBom.Close()}return fso.CopyFile(fpathTmp,fpath,CD.jsOverwrite),fso.DeleteFile(fpathTmp,CD.jsDelReadOnly),!(strm=null)}catch(e){throw new Error(ERR_TITLE+"(writeFileSync)\n  file: "+fpath+"\n  encoding: "+encoding+"\n  bom: "+bom+"\n"+e.toParsed())}},fs.getAllPaths=function(dirpath,options){if(fs.inspectPathWhetherMAX_PATH(dirpath),!fso.FolderExists(dirpath))throw new Error(ERR_TITLE+'(getAllPaths)\n  Folder "'+dirpath+'" is not existing.');var command="dir "+path.normalize(dirpath).toFilePath();pullVal(options,"isOnlyDir",!1)?command+=" /A:D /B /N /S /O:N":command+=" /B /N /S /O:N";var oExec,exeCmd='CMD.EXE /S /C"'+command+'"';if(0!==(oExec=sh.Exec(exeCmd)).ExitCode)throw new Error("Error in fs.getAllPaths:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());var fullPaths=oExec.StdOut.ReadAll().split("\r\n");return fullPaths.pop(),pullVal(options,"isIncludingSymlink",!0)?fullPaths:fs.excludeSymboliclinkPaths(fullPaths)},fs.excludeSymboliclinkPaths=function(filePaths){var symlinkPaths=[];return filePaths.filter(function(fp){for(var i=0,len=symlinkPaths.length;i<len;i++)if(0===fp.indexOf(symlinkPaths[i]))return!1;return!fs.statSync(fp).isSymbolickLink()||(symlinkPaths.push(fp),!1)})},fs.getFolderNames=function(dirpath,matchedRegExp,ignoredRegExp){var dirPairs=[];if(/^\\\\[^\\]+(\\)?$/i.test(dirpath)){var oExec,command="net view "+dirpath,exeCmd='CMD.EXE /S /C"'+command+'"';try{for(oExec=sh.Exec(exeCmd);0==oExec.Status;)WScript.Sleep(300)}catch(e){throw new Error(ERR_TITLE+"(getFolderNames)\n  command: "+exeCmd+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll()+"\n"+e.toParsed())}if(0!==oExec.ExitCode)throw new Error(ERR_TITLE+"(getFolderNames)\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());dirPairs=oExec.StdOut.ReadAll().match(/\w+\s+Disk/g).map(function(val){return val.match(/(\w+)\s+Disk/)[1]})}else{if(fs.inspectPathWhetherMAX_PATH(dirpath),!fso.FolderExists(dirpath))throw new Error('Error in fs.getFolderNames:\n  Folder "'+dirpath+'" is not existing.');var enm=new Enumerator(fso.GetFolder(dirpath).SubFolders);for(enm.moveFirst();!enm.atEnd();enm.moveNext())dirPairs.push(enm.item().Name.toString())}var mtchRE=isEmp(matchedRegExp)?null:new RegExp(matchedRegExp,"i"),ignrRE=isEmp(ignoredRegExp)?null:new RegExp(ignoredRegExp,"i");return dirPairs.filter(function(dirName){return!(null!==mtchRE&&!mtchRE.test(dirName))&&(null===ignrRE||!ignrRE.test(dirName))})},fs.getFileNames=function(dirpath,matchedRegExp,ignoredRegExp){if(fs.inspectPathWhetherMAX_PATH(dirpath),!fso.FolderExists(dirpath))throw new Error('Error in fs.getFileNames:\n  Folder "'+dirpath+'" is not existing.');var files=fso.GetFolder(dirpath).Files,enm=new Enumerator(files),filename="",filenames=[],mtchRE=isEmp(matchedRegExp)?null:new RegExp(matchedRegExp,"i"),ignrRE=isEmp(ignoredRegExp)?null:new RegExp(ignoredRegExp,"i");for(enm.moveFirst();!enm.atEnd();enm.moveNext())filename=enm.item().Name.toString(),null!==mtchRE&&!mtchRE.test(filename)||null!==ignrRE&&ignrRE.test(filename)||filenames.push(filename);return filenames},fs.readdirSync=function(dirpath,options){if(fs.inspectPathWhetherMAX_PATH(dirpath),!fso.FolderExists(dirpath))throw new Error('Error in fs.readdirSync:\n  Folder "'+dirpath+'" is not existing.');var enm,itm,isSymlink,objDir=fso.GetFolder(path.normalize(dirpath)),withFileTypes=pullVal(options,"withFileTypes",!1),isIncludingSymlink=pullVal(options,"isIncludingSymlink",!0),matchedRegExp=pullVal(options,"matchedRegExp",null),ignoredRegExp=pullVal(options,"ignoredRegExp",null),mtchRE=isEmp(matchedRegExp)?null:new RegExp(matchedRegExp,"i"),ignrRE=isEmp(ignoredRegExp)?null:new RegExp(ignoredRegExp,"i"),dirName="",dirNames=[],dirs=objDir.SubFolders;for((enm=new Enumerator(dirs)).moveFirst();!enm.atEnd();enm.moveNext())if(dirName=(itm=enm.item()).Name.toString(),(null===mtchRE||mtchRE.test(dirName))&&(null===ignrRE||!ignrRE.test(dirName)))if(withFileTypes){if((isSymlink=fs.statSync(itm.Path).isSymbolickLink())&&!isIncludingSymlink)continue;dirNames.push({name:dirName,path:itm.Path,attributes:itm.Attributes,isDirectory:!0,isFile:!1,isSymbolicLink:isSymlink,dateCreated:parseDate(null,new Date(itm.DateCreated)),dateModified:parseDate(null,new Date(itm.DateLastModified))})}else dirNames.push(dirName);var filename="",filenames=[],files=objDir.Files;for((enm=new Enumerator(files)).moveFirst();!enm.atEnd();enm.moveNext())if(itm=enm.item(),filename=enm.item().Name.toString(),(null===mtchRE||mtchRE.test(filename))&&(null===ignrRE||!ignrRE.test(filename)))if(withFileTypes){if((isSymlink=fs.statSync(itm.Path).isSymbolickLink())&&!isIncludingSymlink)continue;filenames.push({name:filename,path:itm.Path,attributes:itm.Attributes,isDirectory:!1,isFile:!0,isSymbolicLink:isSymlink,size:itm.Size,dateCreated:parseDate(null,new Date(itm.DateCreated)),dateModified:parseDate(null,new Date(itm.DateLastModified))})}else filenames.push(filename);return dirNames.concat(filenames)}}();
if(!Wsh)var Wsh={};Wsh.OS={},function(){var util=Wsh.Util,CD=Wsh.Constants,path=Wsh.Path,fs=Wsh.FileSystem,pullVal=util.obtainPropVal,isEmp=util.types.isProbablyEmpty,sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var fso=Wsh.FileSystemObject;fso=fso||WScript.CreateObject("Scripting.FileSystemObject");var os=Wsh.OS;os.env=function(){for(var itm,enmSet=new Enumerator(sh.Environment("PROCESS")),i=0,rtnAssoc={};!enmSet.atEnd();enmSet.moveNext())itm=enmSet.item(),/^=/.test(itm)||-1===itm.indexOf("=")||(i=itm.indexOf("="),rtnAssoc[itm.slice(0,i)]=itm.slice(i+1));return rtnAssoc}(),os.EOL="\r\n";var osArch=undefined;os.arch=function(){return osArch!==undefined||"x86"!==(osArch=os.env.PROCESSOR_ARCHITECTURE.toLowerCase())||isEmp(os.env.PROCESSOR_ARCHITEW6432)||(osArch=os.env.PROCESSOR_ARCHITEW6432.toLowerCase()),osArch},os.freemem=function(){return 1024*Number(os.getLocalCompOsInfo().FreePhysicalMemory)},os.homedir=function(){return path.join(os.env.HOMEDRIVE,os.env.HOMEPATH)},os.hostname=function(){return os.env.COMPUTERNAME},os.platform=function(){return"win32"},os.release=function(){return os.getLocalCompOsInfo().Version},os.tmpdir=function(){return os.env.TMP},os.totalmem=function(){return 1024*Number(os.getLocalCompOsInfo().TotalVisibleMemorySize)},os.type=os.env.OS,os.userInfo=function(){return{uid:-1,gid:-1,username:os.env.USERNAME,homedir:os.env.USERPROFILE,shell:null}};var writeLogEvent,is64arch=undefined;os.is64arch=function(){if(is64arch!==undefined)return is64arch;var arch=os.arch();return is64arch="amd64"===arch||"ia64"===arch||"x86"!==arch},os.exec=function(command,options){var oExec,exeCmd=pullVal(options,"inCMD",!1)?'CMD.EXE /S /C"'+command+'"':command,isAsync=pullVal(options,"isAsync",!1);try{if(oExec=sh.Exec(exeCmd),!isAsync)for(;0==oExec.Status;)WScript.Sleep(300)}catch(e){throw WScript.Echo("Error in os.exec:\n  command: "+exeCmd+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll()),e}return oExec},os.setStrToClipboardAO=function(str){var dynwrap=new ActiveXObject("DynamicWrapper");dynwrap.register("ole32","OleInitialize","f=s","i=l","r=l"),dynwrap.OleInitialize(0),new ActiveXObject("htmlfile").parentWindow.clipboardData.setData("text",str)},os.getStrFromClipboard=function(){return new ActiveXObject("htmlfile").parentWindow.clipboardData.getData("text")},writeLogEvent=function(type,text){try{sh.LogEvent(type,text)}catch(e){throw WScript.Echo("Error in os.writeLogEvent:\n  Failed to write the log event.\n  text: "+text),e}},os.writeLogEvent={success:function(text){writeLogEvent(CD.successLog,text)},error:function(text){writeLogEvent(CD.errLog,text)},warn:function(text){writeLogEvent(CD.warningLog,text)},info:function(text){writeLogEvent(CD.infoLog,text)}},os.getWMIObjects=function(query){var wbem=Wsh.WBEM;wbem=wbem||WScript.CreateObject("WbemScripting.SWbemLocator");var wmiObjs=[];try{for(var swbemSet=wbem.ConnectServer(null,"root\\CIMV2").ExecQuery(query),swbemSetEnumed=new Enumerator(swbemSet);!swbemSetEnumed.atEnd();)wmiObjs.push(swbemSetEnumed.item()),swbemSetEnumed.moveNext()}catch(e){throw WScript.Echo("Error in os.getWmiObjects:\n  Failed to get a WMI object.\n  query: "+query),e}return wmiObjs},os.convertWMIPropsToAssocObj=function(wmiObj){try{for(var prop,val,props=wmiObj.Properties_,enmProps=new Enumerator(props),assoc={};!enmProps.atEnd();)val=(prop=enmProps.item()).Value,prop.IsArray&&null!==val&&(val=new VBArray(val).toArray()),assoc[prop.Name]=val,enmProps.moveNext()}catch(e){throw WScript.Echo("Error in os.convertWMIPropsToAssocObj:\n  Failed to convert a WMI object."),e}return assoc},os.getWMIProps=function(query){for(var wmiObjs=os.getWMIObjects(query),assoc={},wmiProps=[],i=0,I=wmiObjs.length;i<I;i++)assoc=os.convertWMIPropsToAssocObj(wmiObjs[i]),isEmp(assoc)||wmiProps.push(assoc);return wmiProps},os.getWMIObjWithSWbemPath=function(swbemPath){var wbem=Wsh.WBEM;wbem=wbem||WScript.CreateObject("WbemScripting.SWbemLocator");var rtnWmiObj=null;try{rtnWmiObj=wbem.ConnectServer(null,"root\\CIMV2").Get(swbemPath)}catch(e){rtnWmiObj=null}return rtnWmiObj},os.getEnumLocalCompWMICollection=function(query){var collectionQueriedWmi=GetObject("winmgmts:\\\\.\\root\\cimv2").ExecQuery(query);return new Enumerator(collectionQueriedWmi)},os.getLocalCompWMIProperties=function(query){var props,eProps,prop,val,objProps,enumComp=os.getEnumLocalCompWMICollection(query),rtnArray=[];try{for(enumComp.moveFirst();!enumComp.atEnd();enumComp.moveNext()){for(props=enumComp.item().Properties_,eProps=new Enumerator(props),objProps={},eProps.moveNext();!eProps.atEnd();eProps.moveNext())val=null===(prop=eProps.item()).Value?null:prop.IsArray?new VBArray(prop.Value).toArray():prop.Value,objProps[prop.Name]=val;rtnArray.push(objProps)}}catch(e){throw WScript.Echo("Error in os.getLocalCompWMIProperties:\n  Failed to get a WMI object.\n  query: "+query),e}return val=eProps=enumComp=null,rtnArray},os.getLocalCompOsInfo=function(){return os.getLocalCompWMIProperties("SELECT * FROM Win32_OperatingSystem")[0]},os.getWindowsUserAccounts=function(){return os.getLocalCompWMIProperties("SELECT * FROM Win32_UserAccount")};var hasUAC=undefined;os.hasUAC=function(){return hasUAC!==undefined?hasUAC:hasUAC=(parseFloat(os.getLocalCompOsInfo().Version.slice(0,3)),!0)},os.isUacDisable=function(){var regUac="HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System";return sh.RegRead(regUac+"\\ConsentPromptBehaviorAdmin")+sh.RegRead(regUac+"\\PromptOnSecureDesktop")+sh.RegRead(regUac+"\\EnableLUA")===0},os.getAllProcessesProps=function(){return os.getWMIProps("SELECT * FROM Win32_Process")},os.getProcessObjs=function(appStr,matchWords,excludingWords){if(isEmp(appStr))throw new Error("Error in os.getProcessObjs:\n  appStr is empty: "+appStr);var query="SELECT Caption, CommandLine, ExecutablePath, ProcessID FROM Win32_Process";if(/^[0-9]+$/.test(appStr))return query+=" WHERE ProcessID="+appStr,os.getWMIObjects(query);var strExe=/^"/.test(appStr)?appStr.match(/^"([^"]+)"/)[1]:appStr.match(/^[^\s]+/)[0],fpExe=/\\/.test(strExe)?strExe:"",fnExe=""!==fpExe?fpExe.match(/^.+\\(.+)/)[1]:strExe;query+=' WHERE Caption="'+fnExe+'"';var wmiObjs=os.getWMIObjects(query);if(0===wmiObjs.length)return[];util.types.isString(matchWords)?matchWords=[matchWords]:util.types.isArray(matchWords)||(matchWords=[]);var cmdArg=appStr.replace(strExe,"").replace('""',"").trim();isEmp(cmdArg)||matchWords.push(cmdArg),matchWords.push(fpExe.replace(fnExe,"")),util.types.isString(excludingWords)?excludingWords=[excludingWords]:util.types.isArray(excludingWords)||(excludingWords=[]);var props,isExcluded=!1,processObjs=[];try{for(var i=0,I=wmiObjs.length;i<I;i++)if(props=os.convertWMIPropsToAssocObj(wmiObjs[i]),isEmp(props.CommandLine))WScript.Echo("Warning in os.getProcessObjs:\n  Failed to get a CommandLine. Different WIL?\n  ProcessId: "+props.ProcessId+"\n  Caption: "+props.Caption);else{isExcluded=!1;for(var j=0,J=matchWords.length;j<J;j++)if(props.CommandLine.toLowerCase().indexOf(matchWords[j].toLowerCase())<0){isExcluded=!0;break}if(!isExcluded)for(var k=0,K=excludingWords.length;k<K;k++)if(0<props.CommandLine.toLowerCase().indexOf(excludingWords[k].toLowerCase())){isExcluded=!0;break}isExcluded||processObjs.push(wmiObjs[i])}}catch(e){throw WScript.Echo("Error in os.getProcessObjs:\n  Failed to get a WMI object.\n  query: "+query),e}return processObjs},os.getProcessProps=function(proc){var pID=proc;if(!/^\d+$/.test(pID)){var pIDs=os.getProcessIDs(proc);if(0===pIDs.length())return null;pID=pIDs[0]}var wmiProps=os.getWMIProps("SELECT * FROM Win32_Process WHERE ProcessID="+pID);return 0===wmiProps.length?null:wmiProps[0]},os.getProcessIDs=function(appStr,matchWords,excludingWords){for(var wmiObjs=os.getProcessObjs(appStr,matchWords,excludingWords),assoc={},rtnProcessIds=[],i=0,I=wmiObjs.length;i<I;i++)assoc=os.convertWMIPropsToAssocObj(wmiObjs[i]),isEmp(assoc)||rtnProcessIds.push(assoc.ProcessId);return rtnProcessIds},os.activateApp=function(appStr,matchWords,excludingWords){if(/^[0-9]+$/.test(appStr))return sh.AppActivate(appStr),appStr;for(var pIDs=os.getProcessIDs(appStr,matchWords,excludingWords),i=0,I=pIDs.length;i<I;i++)return sh.AppActivate(pIDs[i]),pIDs[i]},os.terminateApp=function(appStr,matchWords,excludingWords){for(var wmiObjs=os.getProcessObjs(appStr,matchWords,excludingWords),i=0,I=wmiObjs.length;i<I;i++)wmiObjs[i].Terminate()},os.createTaskOfTaskSchduler=function(taskName,exe,argsStr){var iRetVal,command='SchTasks.exe /Create /F /TN "'+taskName+'" /SC ONCE /ST 23:59 /IT /RL LIMITED /TR "'+exe.toFilePath().replace(/(^\\{0}"|\\{0}"$)/g,'\\"')+(isEmp(argsStr)?"":" "+argsStr.toString().replace(/\\{0}"/g,'\\"').replace(/\^{0}>/g,"^>"))+'"';try{iRetVal=sh.Run(command,CD.winHidden,CD.wait)}catch(e){throw WScript.Echo("Error in os.createTaskOfTaskSchduler:\n  command: "+command),e}var isCreated=iRetVal===CD.runOk;if(!isCreated)throw new Error("Error in os.createTaskOfTaskSchduler:\n  Failed to create the task: "+taskName+"\n  command: "+command);return isCreated},os.confirmTaskToExist=function(taskName){var iRetVal,command='SchTasks.exe /Query /XML /TN "'+taskName+'"';try{iRetVal=sh.Run(command,CD.winHidden,CD.wait)}catch(e){throw WScript.Echo("Error in os.confirmTaskToExist:\n  command: "+command),e}return iRetVal===CD.runOk},os.ensureCreatingNewTask=function(taskName,exe,argsStr,msecTimeOut){if(os.confirmTaskToExist(taskName)&&!os.ensureRemovingTask(taskName))throw new Error("Error in os.ensureCreatingNewTask:\n  Failed to delete the existing task: "+taskName);if(!os.createTaskOfTaskSchduler(taskName,exe,argsStr))throw new Error("Error in os.ensureCreatingNewTask:\n  Failed to create the task: "+taskName+"\n  exe: "+exe+"\n  argsStr: "+argsStr);var isCreated=!1;isEmp(msecTimeOut)&&(msecTimeOut=3e4);do{try{if(isCreated=os.confirmTaskToExist(taskName))return!0}catch(e){isCreated=!1}msecTimeOut-=300,WScript.Sleep(300)}while(!isCreated&&0<msecTimeOut);return isCreated},os.runTaskOfTaskSchduler=function(taskName){var command='SchTasks.exe /Run /I /TN "'+taskName+'"';try{sh.Run(command,CD.winHidden,CD.notWait)}catch(e){throw WScript.Echo("Error in os.runTaskOfTaskSchduler:\n  command: "+command),e}},os.deleteTaskOfTaskSchduler=function(taskName){var iRetVal,command='SchTasks.exe /Delete /F /TN "'+taskName+'"';try{iRetVal=sh.Run(command,CD.winHidden,CD.wait)}catch(e){throw WScript.Echo("Error in os.deleteTaskOfTaskSchduler:\n  command: "+command),e}return iRetVal===CD.runOk},os.ensureRemovingTask=function(taskName,msecTimeOut){if(!os.confirmTaskToExist(taskName))return!0;var isRemoved=!1;isEmp(msecTimeOut)&&(msecTimeOut=3e4);do{try{if(isRemoved=os.deleteTaskOfTaskSchduler(taskName),!os.confirmTaskToExist(taskName))return!0}catch(e){isRemoved=!1}msecTimeOut-=300,WScript.Sleep(300)}while(!isRemoved&&0<msecTimeOut);return isRemoved},os.execFileInTaskSchduler=function(file,argsStr,options){isEmp(argsStr)&&(argsStr="");var show=parseInt(pullVal(options,"show",CD.winActiveDef),10),taskName="WSH_EXEC_FILE_IN_TASKSCHDULER"+("0"+(new Date).getSeconds()).slice(-2),tmpJs=path.createTmpPath("execFileAsUser_task-",".js"),tmpCode="WScript.CreateObject('WScript.Shell').Run('"+file.toFilePath().replace(/\\{1}/g,"\\\\")+" "+argsStr.replace(/\\{1}/g,"\\\\")+"', "+show+", "+CD.notWait+");";if(fs.writeFileSync(tmpJs,tmpCode,{encoding:"Shift_JIS"}),!os.ensureCreatingNewTask(taskName,"wscript.exe",tmpJs))throw new Error("Error in WshChildProcess.js(execFileAsUser):\n  Failed to create the task: "+taskName+"\n  wscript.exe "+tmpJs+"\n  tmpCode: "+tmpCode);if(os.runTaskOfTaskSchduler(taskName),!os.ensureRemovingTask(taskName))throw new Error("Error in WshChildProcess.js(execFileAsUser):\n  Failed to remove the task: "+taskName);fs.unlinkSync(tmpJs)},os.registTaskForExecutingHighWIL=function(){},os.addUser=function(userName,usersPass){var command="net user "+userName+" "+usersPass+" /ADD /Y",oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in os.addUser:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},os.addAdminAuthorityToUser=function(userName){var command="net localgroup Administrators "+userName+" /ADD /Y",oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in os.addAdminAuthorityToUser:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},os.deleteUser=function(userName){var command="net user "+userName+" /DELETE /Y",oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in os.deleteUser:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},os.isExistingDrive=function(driveLetter){return fso.DriveExists(driveLetter)},os.getDrivesInfo=function(){for(var drv,drvs=new Enumerator(fso.Drives),rtnDrvs=[];!drvs.atEnd();)(drv=drvs.item()).IsReady&&rtnDrvs.push({letter:drv.DriveLetter,name:drv.VolumeName,type:drv.DriveType}),drvs.moveNext();return rtnDrvs},os.getTheLastFreeDriveLetter=function(){for(var driveLetter,freeDriveLetter="",i=26;2<=i;i--)if(driveLetter=String.fromCharCode(64+i),!os.isExistingDrive(driveLetter)){freeDriveLetter=driveLetter;break}return freeDriveLetter},os.getHardDriveLetters=function(){return os.getDrivesInfo().filter(function(val){return val.type===CD.hardDrive})},os.assignDriveLetter=function(dirPath,letter,userName,pass){var command="net use "+letter+": "+dirPath;isEmp(userName)||isEmp(pass)||(command="net use "+letter+": "+dirPath+" /user:"+userName+" "+pass.toCmdArg());var oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in os.assignDriveLetter:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},os.removeAssignedDriveLetter=function(letter){var command="net use "+letter+": /delete",oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in os.removeAssignedDriveLetter:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0}}();
if(!Wsh)var Wsh={};Wsh.Process={},function(){var util=Wsh.Util,CD=Wsh.Constants,os=Wsh.OS,fso=Wsh.FileSystemObject;fso=fso||WScript.CreateObject("Scripting.FileSystemObject");var sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var process=Wsh.Process;process.arch=os.arch(),process.cwd=function(){return sh.CurrentDirectory},process.env=os.env,process.execPath=WScript.FullName,process.kill=os.terminateApp,process.platform=os.platform,process.release={name:ScriptEngine()},process.versions={wsh:WScript.Version,jscript:ScriptEngineMajorVersion()+"."+ScriptEngineMinorVersion()+"."+ScriptEngineBuildVersion()},process.version="v"+process.versions.jscript,process.argv=[process.execPath,WScript.ScriptFullName],process.argp={F:undefined,Xn:[]},function(){if(0<WScript.Arguments.length)for(var arg="",i=0,I=WScript.Arguments.length;i<I;i++)arg=WScript.Arguments(i).toString(),process.argv.push(arg),0===i?process.argp.F=arg:process.argp.Xn.push(arg)}(),process.argv0=process.argv[0],process.exitCode=0,process.exit=function(exitCode){if(1===exitCode)try{WScript.Quit(1)}catch(e){}else if(isNaN(parseInt(exitCode,10)))try{WScript.Quit(0)}catch(e){}else try{WScript.Quit(process.exitCode)}catch(e){}},process.wait=function(waitSec){var command="TIMEOUT /T "+parseInt(waitSec,10);return sh.Run(command,CD.winNonActive,CD.wait)===CD.runOk};var isAdmin=undefined;process.isAdmin=function(){if(isAdmin===undefined){var rtn=1;try{rtn=sh.Run("net session",CD.winHidden,CD.wait)}catch(e){rtn=null}isAdmin=0===rtn}return isAdmin}(),process.restartAsAdmin=function(options){if(!process.isAdmin){if(-1!==process.argv.indexOf("/PREVENTS_INFINITE_LOOP"))throw new Error("Error in process.restartAsAdmin:\n  averted a infinite loop.\n  argv: ["+process.argv.join(", ")+"]");var app=Wsh.Application;app=app||WScript.CreateObject("Shell.Application");var argsStr=process.argv.slice(1,process.argv.length).reduce(function(acc,val){return acc+'"'+val+'" '},"")+"/PREVENTS_INFINITE_LOOP",show=parseInt(util.obtainPropVal(options,"show",CD.winActiveDef),10);try{app.ShellExecute(process.execPath,argsStr,"","runas",show)}catch(e){throw WScript.Echo("Error in process.restartAsAdmin:"),e}WScript.Quit(0)}},process.restartAsUser=function(options){if(process.isAdmin){if(-1!==process.argv.indexOf("/PREVENTS_INFINITE_LOOP"))throw new Error("Error in process.restartAsUser:\n  averted a infinite loop.\n  argv: ["+process.argv.join(", ")+"]");var argsStr=process.argv.slice(1,process.argv.length).reduce(function(acc,val){return acc+'"'+val+'" '},"")+"/PREVENTS_INFINITE_LOOP";os.execFileInTaskSchduler(process.execPath,argsStr,options),WScript.Quit(0)}}}();
if(!Wsh)var Wsh={};Wsh.FileSystemExtra={},function(){var util=Wsh.Util,CD=Wsh.Constants,path=Wsh.Path,fs=Wsh.FileSystem,os=Wsh.OS,process=Wsh.Process,pullVal=util.obtainPropVal,isEmp=util.types.isProbablyEmpty,parseDate=util.createDateStrAsIso8601,sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var fso=Wsh.FileSystemObject;fso=fso||WScript.CreateObject("Scripting.FileSystemObject");var fse=Wsh.FileSystemExtra,ERR_TITLE="Error in WshCore/FileSystemExtra.js";fse.ensureDir=function(dirPath){for(var layers=dirPath.split(path.sep),layer="",i=/^\\\\/.test(dirPath)?(layer="\\\\"+layers[2],3):(layer=layers[0],1),I=layers.length;i<I;i++){layer+=path.sep+layers[i];try{if(fs.statSync(layer).isDirectory())continue;fs.mkdirSync(layer)}catch(e){throw new Error(ERR_TITLE+'(ensureDir)\n  Failed to create the directory "'+layer+'".\n  dirPath: "'+dirPath+'"\n'+e.toParsed())}}return!0},fse.copySync=function(src,dest,options){var overwrite=pullVal(options,"overwrite",!0),errorOnExist=pullVal(options,"errorOnExist",!1);if(fs.existsSync(dest)&&!overwrite){if(errorOnExist)throw new Error(ERR_TITLE+'(copySync)\n  "'+dest+'" is already existing.');return!1}try{if(fse.ensureDir(path.dirname(dest)),fs.statSync(src).isFile())fs.copyFileSync(src,dest);else{if(!fs.statSync(src).isDirectory())throw new Error("Error: ENOENT: no such file or directory, stat "+src);fso.CopyFolder(src,dest,CD.jsOverwrite)}}catch(e){var command="xcopy.exe "+src.toFilePath()+" "+dest.toFilePath()+" /R /Y",exeCmd='CMD.EXE /S /C"'+command+'"',oExec=sh.Exec(exeCmd);if(oExec.ExitCode==CD.runErr)throw new Error(ERR_TITLE+"(copySync)\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll())}return!0},fse.removeSync=function(fpath){fs.inspectPathWhetherMAX_PATH(fpath);try{fso.FileExists(fpath)?fso.DeleteFile(fpath,CD.jsDelReadOnly):fso.FolderExists(fpath)&&fso.DeleteFolder(fpath,CD.jsDelReadOnly)}catch(e){throw new Error(ERR_TITLE+'(removeSync)\n  Failed to delete "'+fpath+'"\n'+e.toParsed())}return!0},fse.readJsonSync=function(fpJson,encoding){var rtnAssoc={};isEmp(encoding)&&(encoding="UTF-8");var txtJson=fs.readFileSync(fpJson,{encoding:encoding});return txtJson&&(rtnAssoc=JSON.parse(txtJson)),rtnAssoc},fse.writeJsonSync=function(obj,fpJson,options){var encoding=pullVal(options,"encoding","UTF-8"),indent=pullVal(options,"indent",4),lineEnding=pullVal(options,"lineEnding","\n"),txtJson=JSON.stringify(obj,undefined,indent);return txtJson=txtJson.replace(/\r?\n/g,lineEnding),fs.writeFileSync(fpJson,txtJson,{encoding:encoding})},fse.readCsvFileAs2DArray=function(csvpath,options){for(var encoding=pullVal(options,"encoding","Shift-JIS"),delimiter=pullVal(options,"delimiter",","),lineEnding=pullVal(options,"lineEnding","\r\n"),addsEmptyRow=pullVal(options,"addsEmptyRow",!1),parseStr=function(str){return""===(str=String(str))||'""'===str?"":-1===str.indexOf('"')?str:/^"[^"]+"$/.test(str)?str.replace(/^"(.+)"$/,"$1"):/^"[^"].+[^"]"$/.test(str)?str.replace(/^"(.+)"$/,"$1").replace(/""/g,'"'):str},rows=[],spts=[],cells=[],cell="",rtyArrays=new Array,isJoining=!1,parsed="",i=0,I=(rows=fs.readFileSync(csvpath,{encoding:encoding}).split(lineEnding)).length;i<I;i++)if(cells=[],""!==rows[i])if(1!==(spts=rows[i].split(delimiter)).length){isJoining=!1,parsed="";for(var j=0,J=spts.length;j<J;j++)parsed=parseStr(spts[j]),isJoining?(cell+=","+parsed,/([^"]|"")"$/.test(parsed)&&(isJoining=!1,cell=cell.replace(/""/g,'"').replace(/^"(.+)"$/,"$1"),cells.push(cell),cell="")):/^".*([^"]|"")$/.test(cell=parsed)?isJoining=!0:(cells.push(cell),cell="");""!==cell&&cells.push(cell),rtyArrays.push(cells)}else rtyArrays.push([parseStr(spts[0])]);else addsEmptyRow&&rtyArrays.push([""]);return rtyArrays},fse.readCsvFileAsAssocArray=function(csv,options){var ary=fse.readCsvFileAs2DArray(csv,options);return util.conv2DArrayToAssocArray(ary,options)},fse.ensureReadingFile=function(file,msecTimeOut,options){var textData;options.showsError=!1,isEmp(msecTimeOut)&&(msecTimeOut=3e4);var isRead=!1;do{try{textData=fs.readFileSync(file,options),isRead=!0}catch(e){if((msecTimeOut-=300)<=0)throw e;WScript.Sleep(300)}}while(!isRead&&0<msecTimeOut);return textData},fse.write2DArrayAsCsvFile=function(csvData,destCsv,options){var splitChar=pullVal(options,"splitChar",","),crChar=pullVal(options,"crChar","\r\n"),encoding=pullVal(options,"encoding","Shift-JIS"),csv="",row="";return csvData.forEach(function(cols){cols.forEach(function(col,i,ary){try{isNaN(col)&&(/^="(.*)"$/.test(col)?col='="'+col.match(/^="(.*)"$/)[1].replace(/"/g,'""')+'"':(col=col.replace(/"/g,'""'),/^.*,.*$/.test(col)&&(col='"'+col+'"')))}catch(e){throw new Error(ERR_TITLE+"(write2DArrayAsCsvFile)\nFailed to parse a col value.\n  row: "+console.toString(ary)+"\n"+e.toParsed())}ary[i]=col}),row=cols.join(splitChar),csv+=row+crChar}),fs.writeFileSync(destCsv,csv,{encoding:encoding})},fse.copyFilesWithShell=function(srcPath,destDir){var app=Wsh.Application;app=app||WScript.CreateObject("Shell.Application"),isEmp(destDir)&&(destDir=fso.BuildPath(fso.GetParentFolderName(srcPath),fso.GetBaseName(srcPath))),fso.FolderExists(destDir)||fso.CreateFolder(destDir);var objInput=app.NameSpace(srcPath);return app.NameSpace(destDir).CopyHere(objInput.Items(),16),!0},fse.ensureRemovingFile=function(fpath,msecTimeOut){isEmp(msecTimeOut)&&(msecTimeOut=3e4);var rtnBool=!1;if(fso.FileExists(fpath)){do{try{fso.DeleteFile(fpath,CD.jsDelReadOnly)}catch(e){WScript.Sleep(300),msecTimeOut-=300}}while(fso.FileExists(fpath)&&0<msecTimeOut);0<msecTimeOut&&(rtnBool=!0)}else rtnBool=!0;return rtnBool},fse.createTmpListFile=function(vals,options){util.types.isArray(vals)||(vals=[vals]);var tmpList=path.createTmpPath("fse_createTmpListFile-",".txt"),encoding=pullVal(options,"encoding","UTF-8");return fs.writeFileSync(tmpList,vals.reduce(function(acc,val){return acc+val+"\n"},""),{encoding:encoding}),tmpList},fse.shareFolder=function(sharedName,sharedPath,userName){var command="net share "+sharedName+"="+sharedPath+" /GRANT:"+userName+",read",oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in fse.shareFolder:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},fse.deleteShareFolder=function(sharedName){var command="net share "+sharedName+" /DELETE /YES",oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in fse.deleteShareFolder:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},fse.copyWshFilesDefinedInWsf=function(srcWsf,destDir){var srcWsfLines=fs.readFileSync(srcWsf,{encoding:"utf8"}).split("\n"),foWsf=path.dirname(srcWsf),srcFile="",srcFiles=[],destFiles=[];return srcWsfLines.forEach(function(val){/script language="\w+Script" src="/i.test(val)&&(srcFile=val.match(/src="(.+)"><\/script>/i)[1],srcFiles.push(path.normalize(path.join(foWsf,srcFile))),destFiles.push(path.normalize(path.join(destDir,srcFile))))}),srcFiles.forEach(function(val,i){fs.copyFileSync(srcFiles[i],destFiles[i])}),!0},fse.findRequiredFile=function(pathStr,options){var parsed=path.parse(path.normalize(pathStr)),baseDir=parsed.dir,fineName=parsed.base+pullVal(options,"ext",""),fileFound="";if(path.isAbsolute(baseDir))return fileFound=path.join(baseDir,fineName);if(isEmp(baseDir)&&(fileFound=path.join(__dirname,fineName),fs.existsSync(fileFound)))return fileFound;var partFinding=path.join(baseDir,fineName);if(fileFound=path.normalize(path.join(__dirname,partFinding)),fs.existsSync(fileFound))return fileFound;for(var parentDir=path.dirname(__dirname);!isEmp(parentDir);){if(fileFound=path.normalize(path.join(parentDir,partFinding)),fs.existsSync(fileFound))return fileFound;parentDir=path.dirname(parentDir)}return parentDir=os.userInfo().homedir,fileFound=path.normalize(path.join(parentDir,partFinding)),fs.existsSync(fileFound)?fileFound:""},fse.dirTree=function(dirpath,options){if(fs.inspectPathWhetherMAX_PATH(dirpath),!fso.FolderExists(dirpath))throw new Error('Error in fse.dirTree:\n  Folder "'+dirpath+'" is not existing.');var command="dir "+dirpath;pullVal(options,"isDirOnly",!1)&&(command+=" /A:D"),command+=" /B /N /S /O:N";var oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in fse.dirTree:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());var lines=oExec.StdOut.ReadAll().replace(/\r/g,"").split("\n");lines.pop(),lines.sort(function(a,b){return a<b?-1:b<a?1:0});var dirobj={children:[]},dirPt=dirobj;dirobj.path=dirpath,dirobj.name=path.basename(dirpath),dirobj.type="directory";for(var joinedPath,fileExt,exclude=pullVal(options,"exclude",""),regexpExc=new RegExp(exclude),extensions=pullVal(options,"extensions",""),regexpExt=new RegExp(extensions),names=[],isDefined=!1,i=0,I=lines.length;i<I;i++)if(isEmp(exclude)||!regexpExc.test(lines[i])){dirPt=dirobj,joinedPath=dirpath;for(var j=0,J=(names=lines[i].slice(dirpath.length).replace(/^\\+/,"").split(path.sep)).length;j<J;j++){if(joinedPath=path.join(joinedPath,names[j]),!fso.FolderExists(joinedPath)){fileExt="."+path.extname(joinedPath).toLowerCase(),(isEmp(extensions)||regexpExt.test(fileExt))&&dirPt.children.push({path:joinedPath,name:names[j],type:"file",extension:fileExt});break}if(0===dirPt.children.length)dirPt.children.push({path:joinedPath,name:names[j],type:"directory",children:[]}),dirPt=dirPt.children[0];else{isDefined=!1;for(var k=0,K=dirPt.children.length;k<K;k++)if(dirPt.children[k].name===names[j]&&util.hasOwnProp(dirPt.children[k],"children")){dirPt=dirPt.children[k],isDefined=!0;break}isDefined||(dirPt.children.push({path:joinedPath,name:names[j],type:"directory",children:[]}),dirPt=dirPt.children[dirPt.children.length-1])}}}return dirobj},fse.readdirRecursively=function(dirpath,options){var fullpath,dirFullPath=path.normalize(dirpath),isIncludingSymlink=pullVal(options,"isIncludingSymlink",!0),allDirPaths=fs.getAllPaths(dirFullPath,{isOnlyDir:!0,isIncludingSymlink:isIncludingSymlink});allDirPaths.unshift(dirFullPath);var filePaths=[];allDirPaths.forEach(function(fo){filePaths.push(fo),fs.getFileNames(fo).forEach(function(fn){fullpath=path.join(fo,fn),!isIncludingSymlink&&fs.statSync(fullpath).isSymbolickLink()||filePaths.push(fullpath)})}),filePaths.splice(0,1);var matchedRegExp=pullVal(options,"matchedRegExp",null),ignoredRegExp=pullVal(options,"ignoredRegExp",null),mtchRE=isEmp(matchedRegExp)?null:new RegExp(matchedRegExp,"i"),ignrRE=isEmp(ignoredRegExp)?null:new RegExp(ignoredRegExp,"i"),matchedPaths=filePaths.filter(function(fp){var pathBranch=path.relative(dirFullPath,fp);return!(null!==mtchRE&&!mtchRE.test(pathBranch))&&(null===ignrRE||!ignrRE.test(pathBranch))});return pullVal(options,"withFileTypes",!1)?matchedPaths.map(function(fp){var isDir=fs.statSync(fp).isDirectory(),isFile=fs.statSync(fp).isFile(),fsoObj=isDir?fso.GetFolder(fp):fso.GetFile(fp);return{name:path.relative(dirFullPath,fp),path:fp,attributes:fsoObj.Attributes,isDirectory:isDir,isFile:isFile,isSymbolicLink:fs.statSync(fp).isSymbolickLink(),size:fsoObj.Size,dateCreated:parseDate(null,new Date(fsoObj.DateCreated)),dateModified:parseDate(null,new Date(fsoObj.DateLastModified))}}):matchedPaths.map(function(fp){return path.relative(dirFullPath,fp)})},fse.readdirRecursivelyWithDIR=function(dirpath,options){if(fs.inspectPathWhetherMAX_PATH(dirpath),!fso.FolderExists(dirpath))throw new Error('Error in fse.readdirRecursively:\n  Folder "'+dirpath+'" is not existing.');var oExec,command="dir "+dirpath.toFilePath()+" /B /N /S /O:N",exeCmd='CMD.EXE /S /C"'+command+'"';if(0!==(oExec=sh.Exec(exeCmd)).ExitCode)throw new Error("Error in fse.readdirRecursivelyWithDIR:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());var fullPaths=oExec.StdOut.ReadAll().split("\r\n");fullPaths.pop();var rtnName,isDir,withFileTypes=pullVal(options,"withFileTypes",!1),matchedRegExp=pullVal(options,"matchedRegExp",null),ignoredRegExp=pullVal(options,"ignoredRegExp",null),mtchRE=isEmp(matchedRegExp)?null:new RegExp(matchedRegExp,"i"),ignrRE=isEmp(ignoredRegExp)?null:new RegExp(ignoredRegExp,"i"),rtnNames=[];return fullPaths.forEach(function(fullPath){rtnName=fullPath.replace(dirpath,"").replace(/^\\/,""),null!==mtchRE&&!mtchRE.test(rtnName)||null!==ignrRE&&ignrRE.test(rtnName)||(withFileTypes?(isDir=fs.statSync(fullPath).isDirectory(),rtnNames.push({name:rtnName,path:fullPath,isDirectory:isDir,isFile:!isDir})):rtnNames.push(rtnName))}),rtnNames},fse.getTruePath=function(fp){path.isAbsolute(fp)},fse.calcCryptHash=function(filepath,algorithm){if(!fs.existsSync(filepath))throw new Error(ERR_TITLE+'(calcCryptHash)\nNo existing the file ": '+filepath+'"');var oExec,algo=isEmp(algorithm)?"SHA256":algorithm.toUpperCase(),command="certutil -hashfile "+filepath.toFilePath()+" "+algo;try{oExec=os.exec(command,{inCMD:!0,isAsync:!1})}catch(e){var tmpPath=path.join(process.env.TMP,path.createTmpPath("fse-calcCryptHash"));fse.copySync(filepath,tmpPath),command="certutil -hashfile "+tmpPath.toFilePath()+" "+algo,oExec=os.exec(command,{inCMD:!0,isAsync:!1})}if(0!==oExec.ExitCode)throw new Error(ERR_TITLE+"(calcCryptHash)\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return oExec.StdOut.ReadAll().replace(/\r/g,"").split("\n")[1]},fse.isTheSameFile=function(fpA,fpB){if(fs.inspectPathWhetherMAX_PATH(fpA),fs.inspectPathWhetherMAX_PATH(fpB),!fso.FileExists(fpA)||!fso.FileExists(fpB))throw new Error(ERR_TITLE+"(isTheSameFile)\n  file not found:\n  "+fpA+"\n  "+fpB);return fse.calcCryptHash(fpA)===fse.calcCryptHash(fpB)},fse.compareFilesOfModifiedDate=function(srcPath,destPath){var srcDate=fso.GetFile(srcPath).DateLastModified,destDate=fso.GetFile(destPath).DateLastModified;return Math.abs(Number(srcDate)-Number(destDate))<3e3}}();
if(!Wsh)var Wsh={};Wsh.ChildProcess={},function(){var util=Wsh.Util,CD=Wsh.Constants,path=Wsh.Path,fs=Wsh.FileSystem,os=Wsh.OS,process=Wsh.Process,fse=Wsh.FileSystemExtra,pullVal=util.obtainPropVal,isEmp=util.types.isProbablyEmpty,fso=Wsh.FileSystemObject;fso=fso||WScript.CreateObject("Scripting.FileSystemObject");var sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var child_process=Wsh.ChildProcess,ERR_TITLE="Error in WshCore/ChildProcess.js";function execFileAsAdmin(file,argsStr,options){isEmp(argsStr)&&(argsStr="");var show=parseInt(pullVal(options,"show",CD.winActiveDef),10);if(!os.hasUAC()||os.isUacDisable()||process.isAdmin){var strCommand=file.toFilePath()+" "+argsStr;try{return sh.Run(strCommand,show,CD.notWait)}catch(e){throw new Error(ERR_TITLE+"(execFileAsAdmin)\n  strCommand: "+strCommand+"\n"+e.toParsed())}}try{var app=Wsh.Application;return(app=app||WScript.CreateObject("Shell.Application")).ShellExecute(file,argsStr,"","runas",show)}catch(e){throw new Error(ERR_TITLE+"(execFileSync)\n  file: "+file+"\n  argsStr: "+argsStr+"\n"+e.toParsed())}}function execFileAsUser(file,argsStr,options){if(isEmp(argsStr)&&(argsStr=""),!os.hasUAC()||os.isUacDisable()||!process.isAdmin){var strCommand=file.toFilePath()+" "+argsStr,show=parseInt(pullVal(options,"show",CD.winActiveDef),10);try{return sh.Run(strCommand,show,CD.notWait)}catch(e){throw new Error(ERR_TITLE+"(execFileAsUser)\n  strCommand: "+strCommand+"\n"+e.toParsed())}}return os.execFileInTaskSchduler(file,argsStr,options)}child_process.spawnSync=function(file,args){isEmp(args)?args=[]:util.types.isArray(args)||(args=[args]);var argsStr=args.join(" "),command=file.toFilePath()+" "+argsStr,oExec=os.exec(command,{inCMD:!1,isAsync:!1});return{command:command,exitCode:oExec.ExitCode,processId:oExec.ProcessID,error:oExec.ExitCode===CD.runOk,stdout:oExec.StdOut.ReadAll(),stderr:oExec.StdErr.ReadAll()}},child_process.execSync=function(command){var oExec=os.exec(command,{inCMD:!0,isAsync:!1});return{command:command,exitCode:oExec.ExitCode,processId:oExec.ProcessID,error:oExec.ExitCode===CD.runOk,stdout:oExec.StdOut.ReadAll(),stderr:oExec.StdErr.ReadAll()}},child_process.execFile=function(file,args,options){isEmp(args)?args=[]:util.types.isArray(args)||(args=[args]);var argsStr=args.join(" "),show=parseInt(pullVal(options,"show",CD.winActiveDef),10),runsAdmin=pullVal(options,"runsAdmin");if(!0===runsAdmin)return execFileAsAdmin(file,argsStr,options);if(!1===runsAdmin)return execFileAsUser(file,argsStr,options);var strCommand=file.toFilePath()+" "+argsStr;try{return sh.Run(strCommand,show,CD.notWait)}catch(e){throw new Error(ERR_TITLE+"(execFile)\n  strCommand: "+strCommand+"\n"+e.toParsed())}},child_process.execFileSync=function(file,args,options){isEmp(args)?args=[]:util.types.isArray(args)||(args=[args]);var argsStr=args.join(" "),logStdout=path.createTmpPath("execFileSync_stdout-",".log"),logStderr=path.createTmpPath("execFileSync_stderr-",".log"),mainCommand=file.toFilePath()+" "+argsStr,cmdArgsStr='/S /C"'+mainCommand+" 1>"+logStdout+" 2>"+logStderr+'"',rtnDic={error:!0,stdout:"",stderr:"",exitCode:CD.runErr},encoding=pullVal(options,"encoding","Shift-JIS"),show=pullVal(options,"show",CD.winActiveDef),runsAdmin=pullVal(options,"runsAdmin");if(!0===runsAdmin)execFileAsAdmin("CMD.EXE",cmdArgsStr,options);else if(!1===runsAdmin)execFileAsUser("CMD.EXE",cmdArgsStr,options);else try{sh.Run("CMD.EXE "+cmdArgsStr,show,CD.wait)}catch(e){throw new Error(ERR_TITLE+"(execFileSync)\n  cmdStr: CMD.EXE "+cmdArgsStr+"\n"+e.toParsed())}try{rtnDic.stdout=fse.ensureReadingFile(logStdout,3e4,{encoding:encoding}),rtnDic.stderr=fse.ensureReadingFile(logStderr,3e4,{encoding:encoding}),rtnDic.error=isEmp(rtnDic.stderr),rtnDic.exitCode=rtnDic.error?CD.runErr:CD.runOk,rtnDic.command=mainCommand}catch(e){throw new Error(ERR_TITLE+"(execFileSync)\n  Failed to read stdout/err files.\n  cmdStr: CMD.EXE "+cmdArgsStr+"\n"+e.toParsed())}try{fs.statSync(logStdout).isFile()&&fs.unlinkSync(logStdout),fs.statSync(logStderr).isFile()&&fs.unlinkSync(logStderr)}catch(e){throw new Error(ERR_TITLE+"(execFileSync)\n  Failed to remove stdout/err files.\n  cmdStr: CMD.EXE "+cmdArgsStr+"\n"+e.toParsed())}return rtnDic},child_process.execFileViaJSON=function(jsonPath,encoding){isEmp(encoding)&&(encoding="UTF-8");var assoc=fse.readJsonSync(jsonPath,encoding);if(isEmp(assoc))throw new Error("Error in child_process.execFileViaJSON:\n  Failed to read a JSON files.\n  jsonPath: "+jsonPath+"\n  encoding: "+encoding);var rtnAssoc=child_process.execFileSync(assoc.file,assoc.args,assoc.options);fse.writeJsonSync(Object.assign(assoc,rtnAssoc),jsonPath,{encoding:encoding})},child_process.isRunningAsAdmin=function(pID){if("administrator"===process.env.USERNAME.toLowerCase()||!os.hasUAC()||os.isUacDisable())return!0;if(!process.isAdmin){var wmiProps=os.getProcessProps(pID);return isEmp(wmiProps)?undefined:isEmp(wmiProps.ExecutablePath)}var tmpJs=path.createTmpPath("isRunningAsAdmin-",".js"),echoExecPathJs='var W = WScript;var E = new Enumerator(W.CreateObject("WbemScripting.SWbemLocator").ConnectServer(null, "root\\\\CIMV2").ExecQuery("SELECT * FROM Win32_Process WHERE ProcessID='+pID+'"));var ws = [];while (!E.atEnd()) { ws.push(E.item()); E.moveNext(); }if (ws.length === 0) W.Quit(1);var ps = new Enumerator(ws[0].Properties_); var p;while (!ps.atEnd()) {p = ps.item(); if (p.Name === "ExecutablePath") {W.Echo(p.Value); W.Quit(0); } ps.moveNext(); }W.Quit();';fs.writeFileSync(tmpJs,echoExecPathJs,{encoding:"UTF-8"});var rtnDic=child_process.execFileSync("CSCRIPT.EXE","//nologo "+tmpJs,{encoding:"Shift-JIS",show:CD.winHidden,runsAdmin:!1});return fs.unlinkSync(tmpJs),isEmp(rtnDic.stdout)?undefined:!!/^null/.test(rtnDic.stdout)||!path.isAbsolute(rtnDic.stdout.trim())&&void 0},child_process.writeProcessPropsToJson=function(proc,jsonPath){return fse.writeJsonSync(os.getProcessProps(proc),jsonPath)},child_process.registTaskForExecutingHighWIL=function(){},child_process.setExePath=function(setVar,req32,req64,exePath){if(isEmp(exePath)?setVar===undefined&&(setVar=path.join(__dirname,path.parse(setVar).base),fs.statSync(setVar).isFile()||(setVar=isEmp(req64)?fse.findRequiredFile(req32):os.is64arch()?fse.findRequiredFile(req64):fse.findRequiredFile(req32))):setVar=exePath,isEmp(setVar))throw new Error("Error in child_process.setExePath:\n  Failed to find the path\n  req32: "+req32+"\n  req64: "+req64+"\n  exePath: "+exePath);return setVar}}();
if(!Wsh)var Wsh={};Wsh.Net={},function(){var util=Wsh.Util,CD=Wsh.Constants,path=Wsh.Path,fs=Wsh.FileSystem,os=Wsh.OS,child_process=Wsh.ChildProcess,pullVal=util.obtainPropVal,isEmp=util.types.isProbablyEmpty,sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var net=Wsh.Net;net.isReplayedSync=function(host){var rtnAssoc=child_process.execFileSync("ping",[host],{show:CD.winHidden});return!!/(time|時間 )[=<]\d+ms/.test(rtnAssoc.stdout)},net.showIpConfigAll=function(){return sh.Run('CMD.EXE /S /K"ipconfig /all"',CD.winActiveDef,!1)},net.showNetUseResult=function(){return sh.Run('CMD.EXE /S /K"net use"',CD.winActiveDef,!1)},net.getAdaptersConfs=function(options){var query='SELECT * FROM Win32_NetworkAdapterConfiguration WHERE NOT Description LIKE "RAS Async Adapter"';pullVal(options,"excludesVirtual",!0)&&(query+=' AND NOT Description LIKE "%virtual%"'),pullVal(options,"excludesWireless",!1)&&(query+=' AND NOT Description LIKE "%wireless%"'),query+=" AND NOT MACAddress = null";var adapters=os.getWMIProps(query);return pullVal(options,"isConnecting",!1)?adapters.filter(function(val){try{return 0<=val.NetConnectionStatus&&val.NetConnectionStatus<=3}catch(e){return!1}}):adapters},net.getAdaptersProps=function(options){var query="SELECT * FROM Win32_NetworkAdapter WHERE PhysicalAdapter = True";pullVal(options,"excludesVirtual",!0)&&(query+=' AND NOT Description LIKE "%virtual%"'),pullVal(options,"excludesWireless",!1)&&(query+=' AND NOT Description LIKE "%wireless%"'),query+=" AND NOT MACAddress = null";var adapters=os.getWMIProps(query);return pullVal(options,"isConnecting",!1)?adapters.filter(function(val){try{return 0<=val.NetConnectionStatus&&val.NetConnectionStatus<=3}catch(e){return!1}}):adapters},net.getOwnIpAddresses=function(ipVer,options){var adapters=net.getAdaptersConfs(options),iIpVer=!1===isEmp(ipVer)&&"IPV6"===ipVer.toUpperCase()?1:0,rtnIPs=[];return adapters.forEach(function(val){util.hasOwnProp(val,"IPAddress")&&null!==val.IPAddress&&rtnIPs.push(val.IPAddress[iIpVer].toString())}),rtnIPs},net.getDefaultGateways=function(options){var adapters=net.getAdaptersConfs(options),rtnIPs=[];return adapters.forEach(function(val){util.hasOwnProp(val,"DefaultIPGateway")&&null!==val.DefaultIPGateway&&rtnIPs.push(val.DefaultIPGateway.toString())}),rtnIPs},net.getDNSAddresses=function(netAdpSetId){return isEmp(netAdpSetId)&&(netAdpSetId=net.getAdaptersProps()[0].GUID),sh.RegRead("HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\services\\Tcpip\\Parameters\\Interfaces\\"+netAdpSetId+"\\NameServer").split(",")},net.isDHCPEnabling=function(netAdpSetId){isEmp(netAdpSetId)&&(netAdpSetId=net.getAdaptersProps()[0].GUID);var regVal=sh.RegRead("HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\services\\Tcpip\\Parameters\\Interfaces\\"+netAdpSetId+"\\NameServer");return!!isEmp(regVal)},net.getNetworkConnections=function(options){var connections=os.getWMIProps("SELECT * FROM Win32_NetworkConnection"),resourceName=pullVal(options,"resourceName",null);return resourceName?(resourceName=resourceName.toUpperCase(),connections.filter(function(obj){return obj.Name.toUpperCase()==resourceName})):connections},net.isExistingConnection=function(resourceName){var connections=net.getNetworkConnections({resourceName:resourceName});return!isEmp(connections)&&/^(OK|Degraded)$/i.test(connections[0].Status)},net.exportWindowsFirewallSettings=function(fileFw){var pathToExport=path.resolve(fileFw);fs.statSync(pathToExport).isFile()&&fs.unlinkSync(pathToExport);var command='netsh advfirewall export "'+pathToExport+'"',oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in net.exportWindowsFirewallSettings:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},net.setIpAddress=function(netName,ip,mask,defGw){isEmp(netName)&&(netName=net.getAdaptersProps()[0].NetConnectionID);var command='netsh interface ipv4 set address name="'+netName+'"';isEmp(ip)?command+=" source=dhcp":(command+=" source=static address="+ip,isEmp(mask)?command+=" mask=255.255.255.0":command+=" mask="+mask,isEmp(defGw)||(command+=" gateway="+defGw+" gwmetric=1"));var oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in net.setIpAddress:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},net.setIpAddressesWithWMI=function(netName,ip,mask,defGw){isEmp(netName)&&(netName=net.getAdaptersProps()[0].NetConnectionID);var query="SELECT * FROM Win32_NetworkAdapterConfiguration WHERE Index = "+netName,wmiObjs=os.getWMIObjects(query);if(0===wmiObjs.length)throw new Error("Error in net.setIpAddressesWithWMI:\n  Failed to get Win32_NetworkAdapterConfiguration  query: "+query);if(wmiObjs[0].DHCPEnabled?console.log("net.setIpAddressesWithWMI: already DCHP."):rtnCode=wmiObjs[0].EnableDHCP(),isEmp(ip))return isEmp(defGw)||(rtnCode=wmiObjs[0].SetGateways([defGw])),!0;var newMask=isEmp(mask)?"255.255.255.0":mask,rtnCode=wmiObjs[0].EnableStatic([ip],[newMask]);if(0===rtnCode)return isEmp(defGw)||(rtnCode=wmiObjs[0].SetGateways([defGw])),!0;if(1===rtnCode)return console.log("net.setIpAddressesWithWMI:\n  Successful completion, reboot required."),isEmp(defGw)||(rtnCode=wmiObjs[0].SetGateways([defGw])),!0;if(-66===rtnCode)throw new Error("Error in net.setIpAddressesWithWMI:\n  Failed to set EnableStatic.\n  不正なサブネットマスクです。");if(-2147180508===rtnCode)throw new Error("Error in net.setIpAddressesWithWMI:\n  Failed to set EnableStatic.\n  ネットワーク設定画面を閉じて再試行してください。");throw new Error("Error in net.setDnsServers:\n  Failed to set SetDNSServerSearchOrder.\n  rtnCode: "+rtnCode)},net.setDnsServers=function(netName,dns1,dns2){isEmp(netName)&&(netName=net.getAdaptersProps()[0].NetConnectionID);var command='netsh interface ipv4 set dnsservers name="'+netName+'"';isEmp(dns1)?command+=" source=dhcp":command+=" source=static address="+dns1+" register=non validate=no";var oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in os.setDnsServers:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());if(isEmp(dns2))return!0;if(command='netsh interface ipv4 add dnsservers name="'+netName+'" address='+dns2+" index=2 validate=no",0!==(oExec=os.exec(command,{inCMD:!0,isAsync:!1})).ExitCode)throw new Error("Error in os.setDnsServers:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},net.setDnsServersWithWMI=function(netadpIndex,dnsAdds){var query="SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled = True AND Index = "+netadpIndex,wmiObjs=os.getWMIObjects(query);if(0===wmiObjs.length)throw new Error("Error in net.setDnsServersWithWMI:\n  Failed to get Win32_NetworkAdapterConfiguration  query: "+query);var rtnCode=wmiObjs[0].SetDNSServerSearchOrder(dnsAdds);if(0===rtnCode)return!0;if(1===rtnCode)return console.log("net.setDnsServersWithWMI:\n  Successful completion, reboot required."),!0;if(-2147180508===rtnCode)throw new Error("Error in net.setDnsServersWithWMI:\n  Failed to set SetDNSServerSearchOrder.\n  ネットワーク設定画面を閉じて再試行してください。");throw new Error("Error in net.setDnsServersWithWMI:\n  Failed to set SetDNSServerSearchOrder.\n  rtnCode: "+rtnCode)},net.importWindowsFirewallSettings=function(fileFw){var pathToImport=path.resolve(fileFw);if(fs.statSync(pathToImport).isFile())throw new Error('Error in net.importWindowsFirewallSettings:\n  Firewall file is not found. "'+pathToImport+'"');var command='netsh advfirewall import "'+pathToImport+'"',oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode)throw new Error("Error in net.importWindowsFirewallSettings:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},net.getNetArgsToConnectToSharedDir=function(comp,shared,domain,user,pwd){var args=["use"];if(isEmp(shared)?args.push("\\\\"+comp+"\\"+path.ipc):args.push("\\\\"+comp+"\\"+shared),isEmp(pwd))throw new Error("Error in net.getNetArgsToConnectToSharedDir:\n  password is empty. pwd: "+pwd);return args.push(pwd.toCmdArg()),isEmp(domain)?args.push("/user:"+user):args.push("/user:"+domain+"\\"+user),args.push("/persistent:no"),args},net.connectToSharedDir=function(comp,shared,domain,user,pwd){var args=net.getNetArgsToConnectToSharedDir(comp,shared,domain,user,pwd);return child_process.execFile("net",args,{show:CD.winHidden})},net.connectToSharedDirSync=function(comp,shared,domain,user,pwd){var args=net.getNetArgsToConnectToSharedDir(comp,shared,domain,user,pwd),rtnAssoc=child_process.execFileSync("net",args,{show:CD.winHidden});if(rtnAssoc.error)throw new Error("Error in net.connectToSharedDirSync:\n  "+console.toString(rtnAssoc)+"\n  comp: "+comp+"\n  shared: "+shared+"\n  domain: "+domain+"\n  user: "+user);return rtnAssoc},net.getNetCmdToDisconnectToSharedDir=function(comp,shared){var command="net use";return isEmp(comp)?command+=" *":(command+=" \\\\"+comp,isEmp(shared)||(command+="\\"+shared)),command+=" /delete /yes"},net.disconnectToSharedDir=function(comp,shared){var command=net.getNetCmdToDisconnectToSharedDir(comp,shared);return os.exec(command,{inCMD:!0,isAsync:!0})},net.disconnectToSharedDirSync=function(comp,shared){var command=net.getNetCmdToDisconnectToSharedDir(comp,shared),oExec=os.exec(command,{inCMD:!0,isAsync:!1});if(0!==oExec.ExitCode&&2!==oExec.ExitCode)throw new Error("Error in net.disconnectToSharedDirSync:\n  command: "+command+"\n  ExitCode: "+oExec.ExitCode+"\n  StdOut: "+oExec.StdOut.ReadAll()+"\n  StdErr: "+oExec.StdErr.ReadAll());return!0},net.ensureConnectingToSharedDir=function(comp,shared,domain,user,pwd){var serverPath="\\\\"+comp;if(isEmp(shared)?serverPath+="\\"+path.ipc:serverPath+="\\"+shared,net.isExistingConnection(serverPath))return!0;if(net.disconnectToSharedDirSync(comp,shared),!net.isReplayedSync(comp))throw new Error("Error in net.ensureConnectingToSharedDir:\n  Failed to replay the response from "+serverPath);var assoc=net.connectToSharedDirSync(comp,shared,domain,user,pwd);if(0===assoc.exitCode)return!0;if(/1219/.test(assoc.stderr)&&net.disconnectToSharedDirSync(comp,shared)&&0===(assoc=net.connectToSharedDirSync(comp,shared,domain,user,pwd)).exitCode)return!0;throw new Error("Error in net.ensureConnectingToSharedDir:\n  Failed to connect to "+serverPath+"\n"+console.toString(assoc))}}();
if(!Wsh)var Wsh={};Wsh.Commander={},function(){var util=Wsh.Util,CD=Wsh.Constants,process=Wsh.Process,cli=Wsh.Commander;cli.cmd=undefined,cli.args=[];var helpStr="Options:\n\n";cli.help=function(exitCode){console.log(helpStr),util.types.isFunction(exitCode)?(exitCode(),process.exit()):process.exit(exitCode)};var opNames={},preFuncs={};function getPropName(flag){return util.types.isProbablyEmpty(flag)?"":function camelcase(flag){return util.types.isProbablyEmpty(flag)?"":flag.split("-").reduce(function(str,word){return str+word.charAt(0).toUpperCase()+word.slice(1)})}(flag.replace(/^--/,"").replace(/^no-/i,""))}cli.parse=function(usersSchemas){var sflag,pName,preFunc,defVal,getSchemaVal=function(vals,i){return vals.length>i?vals[i]:""};if(!util.types.isArray(usersSchemas))throw new Error("Error in WshCommander.js(cli.parse):\n Failed to parse the schemas :"+usersSchemas);var schemas=usersSchemas;schemas.unshift(["-h","--help","output usage information"]);var arg,maxWidth=0;schemas.forEach(function(schema){var width=schema[1].length;maxWidth<width&&(maxWidth=width)}),schemas.forEach(function(schema){pName=getPropName(schema[1]),defVal=!!/^--no-/i.test(schema[1])||!/^--(is|to|has)-/i.test(schema[1])&&(/^--help$/i.test(schema[1])?cli.help:getSchemaVal(schema,4)),cli[pName]=defVal,sflag=getSchemaVal(schema,0),preFunc=getSchemaVal(schema,3),sflag.match(/^-\w$/i)?(sflag=sflag.replace("-",""),opNames[sflag]=pName,helpStr+="  -"+sflag+", "):helpStr+="    , ",util.types.isFunction(preFunc)&&(preFuncs[pName]=preFunc),helpStr+=schema[1]+" ";for(var i=schema[1].length-1;i<maxWidth;i++)helpStr+=" ";helpStr+=getSchemaVal(schema,2)+"\n"});for(var isAfterOp=!1,showsHelp=!1,i=2,I=process.argv.length;i<I;i++)0===(arg=process.argv[i]).indexOf("--")?(pName=getPropName(arg),isAfterOp=0===arg.indexOf("--no-")?cli[pName]=!1:/^--(is|to|has)-/i.test(arg)?!(cli[pName]=!0):0!==arg.indexOf("--help")||!(showsHelp=!0)):arg.match(/^-\w$/i)?(pName=opNames[arg.replace("-","")],isAfterOp=util.types.isBoolean(cli[pName])?(/^(is|to|has)/i.test(pName)?cli[pName]=!0:cli[pName]=!1,!1):0!==arg.indexOf("-h")||!(showsHelp=!0)):isAfterOp?(util.types.isFunction(preFuncs[pName])&&(arg=preFuncs[pName](arg)),util.types.isArray(cli[pName])?cli[pName].push(arg):cli[pName]=arg,isAfterOp=!1):(cli.args.push(arg),cli.cmd===undefined&&(cli.cmd=arg,helpStr="Usage: "+arg+" [options]\n\n"+helpStr));showsHelp&&cli.help(CD.runOk)},cli.getAllStrsParsed=function(){return Object.keys(cli).reduce(function(acc,val){return util.types.isFunction(cli[val])?acc:acc+val+": "+cli[val]+"\n"},"parsed are \n")}}();
if(!Wsh)var Wsh={};Wsh.Logger={},function(){var util=Wsh.Util,CD=Wsh.Constants,path=Wsh.Path,fs=Wsh.FileSystem,os=Wsh.OS,process=Wsh.Process,fse=Wsh.FileSystemExtra,pullVal=util.obtainPropVal,isEmp=util.types.isProbablyEmpty,parseDate=util.createDateStrAsIso8601,sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var logger=Wsh.Logger,lvPriority={none:0,error:1,warn:2,success:3,info:4};logger.create=function(options){var level=pullVal(options,"level",null),transportation=pullVal(options,"transportation","console");return transportation instanceof logger.Class?(isEmp(level)||transportation.setLevel(level),transportation):new logger.Class({level:level,transportation:transportation})},logger.parseLogsToStr=function(logs,isCR){for(var log,logStr="",lvDisp={info:"info    ",success:"success ",warn:"warn    ",error:"error   "},i=0,I=logs.length;i<I;i++)logStr+="["+(log=logs[i]).timestamp+"]",logStr+=" "+lvDisp[isEmp(log.level)?"info":log.level]+log.message,(isEmp(isCR)||isCR)&&(logStr+=os.EOL);return logStr},logger.createLogObj=function(level,message){return{timestamp:parseDate("yyyy-MM-ddTHH:mm:ss"),level:level,message:message}},logger.showLogsWithConsole=function(logStr){var tmpLog=path.createTmpPath("WshLogWriter_",".log");fs.writeFileSync(tmpLog,logStr,{encoding:"Shift_JIS-8"});var cmdCode='TYPE "'+tmpLog+'"\r\n@PAUSE',tmpCmd=tmpLog.replace(".log",".cmd");fs.writeFileSync(tmpCmd,cmdCode,{encoding:"Shift_JIS-8"}),sh.Run('CMD.EXE /S /K"'+tmpCmd+'"',CD.winActiveDef,!1)},logger.Class=function(params){var dest=pullVal(params,"transportation",null);if(dest)if(isEmp(dest))this.transportation="NONE";else if(/^console$/i.test(dest))this.transportation="CONSOLE";else if(/^popup$/i.test(dest))this.transportation="POPUP";else if(/^winevent$/i.test(dest))this.transportation="WINEVENT";else{this.transportation="FILE",dest=path.resolve(dest);var filename,fsStat=fs.statSync(dest);if(fsStat.isFile())this.logPath=dest;else if(fsStat.isDirectory())filename=parseDate()+".log",this.logPath=path.join(dest,filename);else if(/\$\{.+\}/i.test(dest)){var dateFmt=dest.match(/\$\{(.+)\}/i)[1];this.logPath=dest.replace(/\$\{(.+)\}/i,parseDate(dateFmt))}else this.logPath=dest}this.runsCscript=/cscript\.exe$/i.test(process.execPath),this.encoding=pullVal(params,"encoding","UTF-8"),this.level=pullVal(params,"level","info"),this.logs=[],this.stackingLogs=[],this.clear=function(){this.logs=[]},this.setLevel=function(level){this.level=level},this.stackLog=function(obj){var level=pullVal(obj,"level",null);this.checkLevel(level)&&this.stackingLogs.push(logger.createLogObj(level,obj.message))},this.clearStackingLogs=function(){this.stackingLogs=[]},this.checkLevel=function(level){if(isEmp(level))throw new Error("Error in WshCore/Logger.js(Class.checkLevel)\n  Failed to log. obj.level is empty.");return!(lvPriority[this.level]<lvPriority[level])},this.log=function(obj){var level=pullVal(obj,"level",null);if(this.checkLevel(level)){0<this.stackingLogs.length&&(this.logs=this.logs.concat(this.stackingLogs),this.clearStackingLogs());var message=pullVal(obj,"message","");this.logs.push(logger.createLogObj(level,message)),"CONSOLE"===this.transportation&&this.runsCscript&&(console.log(logger.parseLogsToStr(this.logs,!1)),this.clear())}},this.info=function(message){this.log({level:"info",message:message})},this.success=function(message){this.log({level:"success",message:message})},this.warn=function(message){this.log({level:"warn",message:message})},this.error=function(message){this.log({level:"error",message:message})},this.transport=function(){if(null!==this.transportation&&"NONE"!==this.transportation){var logStr="";if("FILE"===this.transportation)try{logStr=fs.readFileSync(this.logPath,{encoding:this.encoding})}catch(e){var errStr=e.toParsed();if(!/no such file or directory/i.test(errStr))throw e;logStr=""}if(logStr+=logger.parseLogsToStr(this.logs,!0),isEmp(logStr))return this.clear();if("CONSOLE"===this.transportation)/cscript\.exe$/i.test(process.execPath)?console.log(logStr):logger.showLogsWithConsole(logStr);else if("POPUP"===this.transportation){var ico=/^error$/i.test(this.level)?CD.icoStop:/^warn$/i.test(this.level)?CD.icoExcl:CD.icoInfomaiton;sh.Popup(logStr,CD.nonAutoClosing,"WshCore/Logger.js",CD.btnOk+ico)}else if("WINEVENT"===this.transportation)os.writeLogEvent[this.level.toLowerCase()](logStr);else if("FILE"===this.transportation)try{fse.ensureDir(path.dirname(this.logPath)),fs.writeFileSync(this.logPath,logStr,{encoding:this.encoding})}catch(e){throw new Error('Error in WshCore/Logger.js(Class.transport)\n  Failed to write the log "'+this.logPath+'".\n'+e.toParsed())}this.clear()}}}}();
if(!Wsh)var Wsh={};Wsh.UserSettings={},function(){var util=Wsh.Util,path=Wsh.Path,os=Wsh.OS,fs=Wsh.FileSystem,fse=Wsh.FileSystemExtra,pullVal=util.obtainPropVal,isEmp=util.types.isProbablyEmpty,isString=util.types.isString,isObject=util.types.isObject,sh=Wsh.Shell;sh=sh||WScript.CreateObject("WScript.Shell");var userset=Wsh.UserSettings,ERR_TITLE="Error in WshCore/UserSettings.js";userset.FILENAME_VARS_DEF="settings.json",userset.localUserDir=path.join(os.homedir(),".config","wsh"),userset.localUserJsonPath=path.join(userset.localUserDir,userset.FILENAME_VARS_DEF),userset.portableDir=path.join(__dirname,".config"),userset.portableJsonPath=path.join(userset.portableDir,userset.FILENAME_VARS_DEF),userset.settings={};userset.load=function(options){var users=pullVal(options,"users",null);return users instanceof userset.Class?users:new userset.Class({users:users})},userset.getVal=function(varObj,varNamesStr){if(isEmp(varNamesStr))throw new Error(ERR_TITLE+'(getVal)\n  The specified varNamesStr is empty "'+varNamesStr+'".');for(var varNames=varNamesStr.split("."),objPointer=varObj,i=0,I=varNames.length;i<I;i++){if(!util.hasOwnProp(objPointer,varNames[i]))return null;objPointer=objPointer[varNames[i]]}return objPointer},userset.setVar=function(varObj,varNamesStr,setVal){if(isEmp(varNamesStr))throw new Error(ERR_TITLE+'(setVar)\n  The specified varNamesStr is empty "'+varNamesStr+'".');for(var varNames=varNamesStr.split("."),objPointer=varObj,i=0,I=varNames.length;i<I;i++){if(i===varNames.length-1){objPointer[varNames[i]]=setVal;break}util.hasOwnProp(objPointer,varNames[i])||(objPointer[varNames[i]]={}),objPointer=objPointer[varNames[i]]}},userset.setVarWithCLI=function(varObj,varNamesStr,options){if(isEmp(varNamesStr))throw new Error(ERR_TITLE+'(setVarWithCLI)\n  The specified varNamesStr is empty "'+varNamesStr+'".');var title=pullVal(options,"title",""),description=pullVal(options,"description",""),defVal=pullVal(options,"defVal",null);console.log(title),console.log(description);var strStdIn=WScript.StdIn.ReadLine();isEmp(strStdIn)&&(strStdIn=defVal),console.log('Set "'+strStdIn+'" to '+varNamesStr),userset.setVar(varObj,varNamesStr,strStdIn)},userset.saveUserSettings=function(objToMerge,specialConfDir){try{userset.loadUserSettings(specialConfDir),userset.settings=Object.merge(userset.settings,objToMerge);var jsonPath=isEmp(specialConfDir)?userset.localUserDir:path.join(specialConfDir,userset.FILENAME_VARS_DEF);return fse.ensureDir(path.dirname(jsonPath)),fse.writeJsonSync(userset.settings,jsonPath)}catch(e){throw console.log('Error in userset.saveUserSettings:\n  Failed to write the JSON "'+jsonPath+'".'),e}},userset.Class=function(params){this.settingsPath=function(specified){return isEmp(specified)?fs.existsSync(userset.portableJsonPath)?userset.portableJsonPath:userset.localUserJsonPath:/^portable$/i.test(specified)?userset.portableJsonPath:/^localuser$/i.test(specified)?userset.localUserJsonPath:path.isAbsolute(specified)?fs.statSync(specified).isFile()?specified:path.resolve(path.join(specified,userset.FILENAME_VARS_DEF)):path.resolve(path.join(__dirname,specified))}(pullVal(params,"users",null)),this.rootObj=function(filePath){try{return fse.readJsonSync(filePath)}catch(e){var errStr=e.toParsed();if(/no such file or directory/i.test(errStr))return{};throw/SyntaxError/i.test(errStr)?new Error(ERR_TITLE+'(loadSettingsFile)\n  [ERROR] Check syntax of the file "'+filePath+'". '+e.toParsed()):e}}(this.settingsPath),this.getSettingsPath=function(){return this.settingsPath},this.getRootObj=function(){return util.deepClone(this.rootObj)},this.getObj=function(module){return isEmp(module)?this.getRootObj():isObject(module)?module:util.deepClone(this.rootObj[module])},this.getVal=function(module,propNamesStr){return userset.getVal(this.getObj(module),propNamesStr)},this.getFullPath=function(module,propNamesStr,options){var fullPath,defPath=pullVal(options,"defPath",""),isNoExistingErr=pullVal(options,"isNoExistingErr",!1),setPath=defPath,propVal=this.getVal(module,propNamesStr);isEmp(propVal)||(isString(propVal)?setPath=propVal:isObject(propVal)&&(setPath=os.is64arch()?propVal["64bit"]:propVal["32bit"])),fullPath=path.isAbsolute(setPath)?setPath:path.normalize(path.join(__dirname,setPath));var fileName=pullVal(options,"fileName",null);if(isEmp(fileName)&&(fullPath=path.join(fullPath,fileName)),isNoExistingErr&&!fs.existsSync(fullPath))throw new Error(ERR_TITLE+'(getFullPath)\n  fullPath: "'+fullPath+'" is not found.\n  propName: "'+propNamesStr+'"\n  fileName: "'+fileName+'"\n  defPath: "'+defPath+'"');return fullPath},this.initialize=function(moduleName){isEmp(moduleName)?this.rootObj={}:this.rootObj[moduleName]={}},this.setObj=function(moduleName,obj){isEmp(moduleName)?this.rootObj=util.deepClone(obj):this.rootObj[this.moduleName]=util.deepClone(obj)},this.setVar=function(moduleName,varNamesStr,setVal){userset.setVar(this.rootObj[this.moduleName],varNamesStr,setVal)},this.setVarWithCLI=function(moduleName,varNamesStr,options){console.log("JSON path: "+this.settingsPath),userset.setVarWithCLI(this.rootObj[this.moduleName],varNamesStr,options)},this.save=function(){try{return fse.ensureDir(path.dirname(this.settingsPath)),fse.writeJsonSync(this.rootObj,this.settingsPath)}catch(e){throw new Error(ERR_TITLE+'(Class.save)\n  Failed to write the file "'+this.settingsPath+'".\n'+e.toParsed())}}}}();
